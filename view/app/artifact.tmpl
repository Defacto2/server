{{- /* 
    artifact.tmpl ~ A layout for the artifact page for a single file record.
*/ -}}
{{- define "content" }}
{{- $colClass := "col-12 col-md-6"}}
{{- $published := index . "published"}}
{{- $desc := index . "description"}}
{{- $classification := brief (index . "platform") (index . "section")}}
{{- $screenElm := screenshot (index . "unid") ($desc)}}
{{- $screenNone := index . "noScreenshot"}}
{{- $topaz := index . "topazCheck"}}
{{- $vga := index . "vgaCheck"}}
{{- $readmeCls := `reader reader-invert border border-black rounded-1 p-1`}}
{{- $readmeL := index . "readmeLatin1" | safeBBS}}
{{- $readmeLS := index . "readmeLatin1Cls"}}
{{- $readmeC := index . "readmeCP437" | safeBBS}}
{{- $readmeCS := index . "readmeCP437Cls"}}
{{- $alertURL := index . "alertURL"}}
{{- $noDownload := index . "noDownload"}}
{{- $readmeName := index . "readmeName"}}
{{- $alert := false}}
{{- if or $alertURL $noDownload}}{{$alert = true}}{{end}}
{{- /*  Info: 
        The title, releasers (as lead) and monospaced filename are generated by 
        Artifact() within dirs.go context and rendered in the layout.tmpl view. 
*/ -}}
<div class="container">
    <div class="row g-2">
        {{- if $alert}}
        {{- /*  End user alerts  */}}
        <div class="alert alert-light" role="alert">
            {{- if ne $alertURL "" }}
            This artifact download has been flagged by Google with an <a href="{{$alertURL}}">unwanted software alert</a>.{{end}}
            {{- if and (ne $alertURL "") ($noDownload) }}<br>{{end}}
            {{- if $noDownload}}Error, the the server cannot locate the file download.{{end}}
            <hr>
        </div>
        {{- end}}
        {{- /*  Editor buttons  */}}
        {{- template "artifactlock" . }}
        <div class="{{$colClass}}">
            {{- /*  Lead including published, platform and section  */}}
            <h4 class="lead mb-4">{{$published}}, {{$classification}}</h4>
            {{- /*  Table of details  */}}
            {{- template "artifactinfo" . }}
        </div>
        {{- if not $screenNone}}
        <div class="{{$colClass}}">
            {{- /*  Screenshot of the file  */}}
            <div class="p-3 text-center">
                <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#artifact-screenshot-modal">{{$screenElm}}</a>
                <span data-bs-toggle="tooltip" data-bs-title="alt + shift + e">
                    <a id="artifact-enlarge-screenshot" class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#artifact-screenshot-modal">Enlarge</a>
                </span>
            </div>
        </div>
        {{- /*  Modal for the full screen screenshot  */}}
        <div class="modal fade" id="artifact-screenshot-modal" tabindex="-1" aria-labelledby="artifact-screenshot-modal-label" aria-hidden="true">
            <div class="modal-dialog modal-fullscreen">
                <div class="modal-content">
                    <div class="modal-header">
                    <h5 class="modal-title" id="artifact-screenshot-modal-label">{{$desc}} screenshot</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">{{$screenElm}}</div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>  
            </div>
        </div>
        {{- end}}
        {{- if or ($readmeL) ($readmeC)}}
        <div class="col-12">
        {{- if not $screenNone}}
            <h6 class="fs-6 fw-lighter">Readme or information text <small>{{$readmeName}}</small></h6>
            {{- end}}
            {{- if $screenNone}}
            <h6 class="fs-6 fw-lighter">Textfile content</small></h6>
            {{- end}}
            <div class="m-3">
                <button class="btn btn-sm btn-outline-secondary" id="artifact-copy-readme-body" 
                    data-bs-toggle="tooltip" data-bs-title="Copy the text to the clipboard">Copy text</button> &nbsp;
                <input type="radio" class="btn-check" name="readme-base" id="monoFont" autocomplete="off">
                <label class="btn btn-sm btn-outline-dark" for="monoFont" 
                    data-bs-toggle="tooltip" data-bs-title="Use the Cascadia Mono font with OEM-US encoding">Cascadia</label>
                <input type="radio" class="btn-check" name="readme-base" id="topazFont" autocomplete="off"{{if ne $topaz ""}} {{$topaz}}{{end}}>
                <label class="btn btn-sm btn-outline-dark" for="topazFont" 
                    data-bs-toggle="tooltip" data-bs-title="Use the TopazPlus font with Latin-1 encoding">Amiga style</label>
                <input type="radio" class="btn-check" name="readme-base" id="vgaFont" autocomplete="off"{{if ne $vga ""}} {{$vga}}{{end}}>
                <label class="btn btn-sm btn-outline-dark" for="vgaFont"
                    data-bs-toggle="tooltip" data-bs-title="Use a classic IBM VGA font with OEM-US encoding">DOS style</label>
            </div>
            <hr>
        {{- if $readmeL -}}
            <pre id="readmeLatin1" class="{{$readmeLS}}font-amiga {{$readmeCls}}">{{$readmeL}}</pre>
        {{- end -}}
        {{- if $readmeC -}}
            <pre id="readmeCP437" class="{{$readmeCS}}font-dos {{$readmeCls}}">{{$readmeC}}</pre>
        {{- end -}}
            </div>
        {{- end}}
    </div>
</div>
{{- template "artifactjsdos" . }}
{{- template "artifactfile" . }}
{{- template "artifactedit" . }}
{{- template "artifacteditjsdos" . }}
{{- end}}