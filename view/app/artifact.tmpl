{{- /* 
    artifact.tmpl ~ A layout for the artifact page for a single file record.
*/ -}}
{{- define "content" }}
{{- $colClass := "col-12 col-md-6"}}
{{- $published := index . "published"}}
{{- $desc := index . "description"}}
{{- $classification := brief (index . "platform") (index . "section")}}
{{- $screenElm := screenshot (index . "uuid") ($desc)}}
{{- $screenNone := index . "noScreenshot"}}
{{- $opensans := index . "openSansCheck"}}
{{- $topaz := index . "topazCheck"}}
{{- $vga := index . "vgaCheck"}}
{{- $readmeCls := index . "readmeCls"}}
{{- $readmeL := index . "readmeLatin1"}}
{{- $readmeLS := index . "readmeLatin1Cls"}}
{{- $readmeC := index . "readmeCP437"}}
{{- $readmeCS := index . "readmeCP437Cls"}}
{{- $unwanted := index . "alertURL"}}
{{- $noDownload := index . "noDownload"}}
{{- $readmeName := index . "readmeName"}}
{{- $alert := false}}
{{- if or $unwanted $noDownload}}{{$alert = true}}{{end}}
{{- /*  Info: 
        The title, releasers (as lead) and monospaced filename are generated by 
        Artifact() within dirs.go context and rendered in the layout.tmpl view. 
*/ -}}
<div class="container">
    <div class="row g-2">
        {{- if $alert}}
        {{- /*  End user alerts  */}}
        <div class="alert alert-light" role="alert">
            {{- if ne $unwanted "" }}
            This artifact download has been flagged by Google with an <a href="{{$unwanted}}">unwanted software alert</a>.{{end}}
            {{- if and (ne $unwanted "") ($noDownload) }}<br>{{end}}
            {{- if $noDownload}}Error, the the server cannot locate the file download.{{end}}
            <hr>
        </div>
        {{- end}}
        {{- /*  Editor buttons  */}}
        {{- template "artifactlock" . }}
        <div class="{{$colClass}}">
            {{- /*  Lead including published, platform and section  */}}
            <h4 class="lead">{{$published}}, {{$classification}}</h4>
            {{- /*  Table of details  */}}
            {{- template "artifactinfo" . }}
        </div>
        {{- if not $screenNone}}
        <div class="{{$colClass}}">
            {{- /*  Screenshot of the file  */}}
            <div class="p-3 text-center">
                <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#screenshotModal">{{$screenElm}}</a>
                <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#screenshotModal">Enlarge</a>
            </div>
        </div>
        {{- /*  Modal for the full screen screenshot  */}}
        <div class="modal fade" id="screenshotModal" tabindex="-1" aria-labelledby="screenshotModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-fullscreen">
                <div class="modal-content">
                    <div class="modal-header">
                    <h5 class="modal-title">{{$desc}} screenshot</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">{{$screenElm}}</div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>  
            </div>
        </div>
        {{- end}}
        {{- if or ($readmeL) ($readmeC)}}
        <div class="col-12">
        {{- if not $screenNone}}
            <h6 class="fs-6 fw-lighter">Readme or information text <small>{{$readmeName}}</small></h6>
            {{- end}}
            {{- if $screenNone}}
            <h6 class="fs-6 fw-lighter">Textfile content</small></h6>
            {{- end}}
            <div class="m-3">                    
                <input type="radio" class="btn-check" name="readme-base" id="openSansFont" autocomplete="off" {{$opensans}}>
                <label class="btn btn-sm btn-outline-dark" for="openSansFont" 
                    data-bs-toggle="tooltip" data-bs-title="Use the OpenSans font with Latin-1 encoding">Open Sans</label>
                <input type="radio" class="btn-check" name="readme-base" id="topazFont" autocomplete="off" {{$topaz}}>
                <label class="btn btn-sm btn-outline-dark" for="topazFont" 
                    data-bs-toggle="tooltip" data-bs-title="Use the TopazPlus font with Latin-1 encoding">Amiga style</label>
                <input type="radio" class="btn-check" name="readme-base" id="vgaFont" autocomplete="off" {{$vga}}>
                <label class="btn btn-sm btn-outline-dark" for="vgaFont"
                    data-bs-toggle="tooltip" data-bs-title="Use a classic IBM VGA font with OEM-US encoding">DOS style</label>
                &nbsp;
                <button class="btn btn-sm btn-outline-secondary" id="copyReadme" 
                    data-bs-toggle="tooltip" data-bs-title="Copy the text to the clipboard">Copy</button>
            </div>
            <hr>
        {{- if $readmeL -}}
            <pre id="readmeLatin1" class="{{$readmeLS}}font-amiga {{$readmeCls}}">{{$readmeL}}</pre>
        {{- end -}}
        {{- if $readmeC -}}
            <pre id="readmeCP437" class="{{$readmeCS}}font-dos {{$readmeCls}}">{{$readmeC}}</pre>
        {{- end -}}
            </div>
        {{- end}}
    </div>
</div>
{{- template "artifactjsdos" . }}
{{- template "artifactfile" . }}
{{- template "artifactedit" . }}
{{- end}}