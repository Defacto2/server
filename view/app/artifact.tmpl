{{- /* 
    artifact.tmpl ~ A layout for the artifact page for a single file record.
*/ -}}
{{- define "content" }}
{{- $published := index . "published"}}
{{- $description := index . "description"}}
{{- $classification := brief (index . "platform") (index . "section")}}
{{- $screenElm := screenshot (index . "unid") ($description)}}
{{- $screenNone := index . "noScreenshot"}}
{{- $topaz := index . "topazCheck"}}
{{- $vga := index . "vgaCheck"}}
{{- $mimetype := index . "magic"}}
{{- $alertURL := index . "alertURL"}}
{{- $noDownload := index . "noDownload"}}
{{- $readmeName := index . "readmeName"}}
{{- $alert := false}}
{{- if or $alertURL $noDownload}}{{$alert = true}}{{end}}
{{- $columnClass := "col-12 col-md-6"}}
{{- /*  Info:
        The following are for text the "ANSI or binary textfile",
        and the "Textfile content"
*/ -}}
{{- $textcontentBinary := index . "contentBinary" }}
{{- $textcontentLatin1 := index . "contentLatin1" | safeBBS }}
{{- $textcontentCP437 := index . "contentCP437" | safeBBS }}
{{- $textcontentUTF8 := index . "contentUTF8" | safeBBS }}
{{- $preclassLatin1 := index . "preClassLatin1" }}
{{- $preclassCP437 := index . "preClassCP437" }}
{{- $preClass := index . "preElementClass" }}
{{- $contentBinarySwappers := index . "contentBinarySwappers" }}
{{- /*  Info: 
        The title, releasers (as lead) and monospaced filename are generated by 
        Artifact() within dirs.go context and rendered in the layout.tmpl view. 
*/ -}}
<div class="container">
    <div class="row g-2">
        {{- if $alert}}
        {{- /*  End user alerts  */}}
        <div class="alert alert-light" role="alert">
            {{- if ne $alertURL "" }}
            Google or Microsoft Defender flags this artifact download as <a href="{{$alertURL}}">unwanted software</a>.{{end}}
            {{- if and (ne $alertURL "") ($noDownload) }}<br>{{end}}
            {{- if $noDownload}}Error, the server cannot locate the file download.{{end}}
            <hr>
        </div>
        {{- end}}
        {{- /*  Editor buttons  */}}
        {{- template "artifactlock" . }}
        <div class="{{$columnClass}}">
            {{- /*  Lead including published, platform and section  */}}
            <h4 class="lead mb-4">{{$published}}, {{$classification}}</h4>
            {{- /*  Table of details  */}}
            {{- template "artifactinfo" . }}
        </div>
        {{- if not $screenNone}}
        <div class="{{$columnClass}}">
            {{- /*  Screenshot of the file  */}}
            <div class="p-3 text-center">
                <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#artifact-screenshot-modal">{{$screenElm}}</a>
                <span data-bs-toggle="tooltip" data-bs-title="alt + shift + e">
                    <a id="artifact-enlarge-screenshot" class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#artifact-screenshot-modal">Enlarge</a>
                </span>
            </div>
        </div>
        {{- /*  Modal for the full screen screenshot  */}}
        <div class="modal fade" id="artifact-screenshot-modal" tabindex="-1" aria-labelledby="artifact-screenshot-modal-label" aria-hidden="true">
            <div class="modal-dialog modal-fullscreen">
                <div class="modal-content">
                    <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title" id="artifact-screenshot-modal-label">üñºÔ∏è Preview, {{$description}}</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body d-flex justify-content-center align-items-center">{{$screenElm}}</div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">‚úï Close</button>
                    </div>
                </div>  
            </div>
        </div>
        {{- end}}
        <style>.font-large{font-size:131%;line-height:100%;}</style>
        {{if and (eq (index . "platform") "textamiga") ($textcontentBinary) }}
        <div class="col-12">
            <div class="m-3">
                <div class="mb-3">
                    <button class="btn btn-sm btn-outline-secondary" id="artifact-copy-textbody" 
                        data-bs-toggle="tooltip" data-bs-title="Copy the text to the clipboard" rel="nofollow">üìã Copy text</button>
                </div>
                <div>
                    <small class="text-body-secondary d-block mb-2"><strong>Font:</strong></small>
                    <div class="btn-group btn-group-sm" role="group">
                        <button type="button" id="textcontBtnTopaz" class="btn btn-outline-dark active">Topaz</button>
                        <button type="button" id="textcontBtnMicroKnight" class="btn btn-outline-dark">MicroKnight</button>
                    </div>
                </div>
            </div>
            <h6 class="fs-6 fw-lighter">Commodore Amiga ANSI text</h6>
            <pre id="precontentBinary" class="{{$preClass}}">{{$textcontentBinary}}</pre>
        </div>
        {{- else if $textcontentBinary -}}
        <div class="col-12">
            <div class="m-3">
                <div class="mb-3">
                    <button class="btn btn-sm btn-outline-secondary" id="artifact-copy-textbody" 
                        data-bs-toggle="tooltip" data-bs-title="Copy the text to the clipboard" rel="nofollow">üìã Copy text</button>
                </div>
                {{- if eq true $contentBinarySwappers }}
                <div>
                    <small class="text-body-secondary d-block mb-2"><strong>Zoom level:</strong></small>
                    <div class="btn-group btn-group-sm" role="group">
                        <button type="button" id="textcontBtnZoom" class="btn btn-outline-dark active">Zoom</button>
                        <button type="button" id="textcontBtn16px" class="btn btn-outline-dark">16 pixels</button>
                        <button type="button" id="textcontBtn08px" class="btn btn-outline-dark">8 pixels</button>
                    </div>
                </div>
                {{- end }}
            </div>
            <h6 class="fs-6 fw-lighter">ANSI encoded or binary text</h6>
            <pre id="precontentBinary" class="{{$preClass}}">{{$textcontentBinary}}</pre>
        </div>
        {{- end -}}
        {{- if or ($textcontentLatin1) ($textcontentCP437)}}
        <div class="col-12">
            <div class="m-3">
                <div class="mb-3">
                    <button class="btn btn-sm btn-outline-secondary" id="artifact-copy-textbody" 
                        data-bs-toggle="tooltip" data-bs-title="Copy the text to the clipboard" rel="nofollow">üìã Copy text</button>
                </div>
                <div>
                    <small class="text-body-secondary d-block mb-2"><strong>Display style:</strong></small>
                    <div class="btn-group btn-group-sm" role="group">
                        <input type="radio" class="btn-check" name="readme-base" id="textcontBtnWeb" rel="nofollow" autocomplete="off">
                        <label class="btn btn-outline-dark" for="textcontBtnWeb" 
                            data-bs-toggle="tooltip" data-bs-title="Use the Cascadia Mono font with UTF-8 encoding">Web style</label>
                        <input type="radio" class="btn-check" name="readme-base" id="textcontBtnAmiga" rel="nofollow" autocomplete="off"{{if ne $topaz ""}} {{$topaz}}{{end}}>
                        <label class="btn btn-outline-dark" for="textcontBtnAmiga" 
                            data-bs-toggle="tooltip" data-bs-title="Use the TopazPlus font with Latin-1 encoding">Amiga style</label>
                        <input type="radio" class="btn-check" name="readme-base" id="textcontBtnDOS" rel="nofollow" autocomplete="off"{{if ne $vga ""}} {{$vga}}{{end}}>
                        <label class="btn btn-outline-dark" for="textcontBtnDOS"
                            data-bs-toggle="tooltip" data-bs-title="Use a classic IBM VGA font with OEM-US encoding">DOS style</label>
                    </div>
                </div>
            </div>
            {{- if not $screenNone}}
            <h6 class="fs-6 fw-lighter">Readme or information text <small>{{$readmeName}}</small></h6>
            {{- end}}
            {{- if $screenNone}}
            <h6 class="fs-6 fw-lighter">Textfile content</h6>
            {{- end}}
        {{- if $textcontentUTF8 -}}
            <pre id="precontentUTF8" class="d-none font-cascadia-mono render {{$preClass}}">{{$textcontentUTF8}}</pre>
        {{- end -}}
        {{- if $textcontentLatin1 -}}
            <pre id="precontentLatin1" style="background-color:#999;color:#000;" class="{{$preclassLatin1}} font-amiga font-large render {{$preClass}}">{{$textcontentLatin1}}</pre>
        {{- end -}}
        {{- if $textcontentCP437 -}}
            <pre id="precontentCP437" class="{{$preclassCP437}} render {{$preClass}}">{{$textcontentCP437}}</pre>
        {{- end -}}
            </div>
        {{- end}}
    </div>
</div>
{{- template "artifactjsdos" . }}
{{- template "artifactfile" . }}
{{- template "artifactedit" . }}
{{- template "artifacteditjsdos" . }}
{{- end}}
