{{- /* 
    artifactinfo.tmpl ~ Artifact information template.
*/ -}}
{{- define "artifactinfo" -}}
{{- $content := index . "content"}}
{{- $alertURL := index . "alertURL"}}
{{- $checksum := index . "checksum"}}
{{- $preview := index . "linkpreview"}}
{{- $previewTip := index . "linkpreviewTip"}}
{{- $jsdos6 := index . "jsdos6"}}
{{- $writers := trimSpace (index . "writers") }}
{{- $artists := trimSpace (index . "artists") }}
{{- $contentLatin1 := index . "contentLatin1"}}
{{- $contentLines := index . "contentLines"}}
{{- $contentRows := index . "contentRows"}}
{{- $programmers := trimSpace (index . "programmers") }}
{{- $musicians := trimSpace (index . "musicians") }}
{{- $demozoo := (index . "demozoo")}}
{{- $pouet := (index . "pouet")}}
{{- $sixteenColors := trimSpace (index . "sixteenColors")}}
{{- $youtube := trimSpace (index . "youtube")}}
{{- $github := trimSpace (index . "github")}}
{{- $comment := trimSpace (index . "comment")}}
{{- $mimetype := index . "magic"}}
{{- $noDownload := index . "noDownload"}}
{{- $contentDesc := index . "contentDesc"}}
{{- $lastModAgo := index . "lastmodifiedAgo"}}
{{- $lastMod := index . "lastmodified"}}
{{- $filesize := index . "filesize"}}
{{- $filebyte := index . "filebyte"}}
{{- $filename := index . "filename"}}
{{- $download := index . "download"}}
{{- $downloadText := print "Download &nbsp; " print $filesize}}
{{- $fileEntry := index . "filentry"}}
{{- $extraZip := index . "extraZip"}}
{{- $editor := index . "editor"}}
{{- $sauce := index . "readmeSAUCE"}}
{{- $sauceTitle := index . "sauceTitle"}}
{{- $sauceAuthor := index . "sauceAuthor"}}
{{- $sauceGroup := index . "sauceGroup"}}
{{- $sauceDate := index . "sauceDate"}}
{{- if $noDownload}}{{$downloadText = print `<span class="text-decoration-line-through">` print $downloadText print "</span>"}}{{end}}
            {{- /*  [FILENAME] Content  */}}
            {{- if $content}}
            <div class="modal fade" id="view-content-modal" tabindex="-1" aria-labelledby="view-content-modal-label" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
                    <div class="modal-content">
                        <div class="modal-header bg-dark text-white">
                            <h5 class="modal-title">üìÅ {{$filename}} - Content</h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="table-responsive">
                            <table class="table table-sm table-striped table-hover align-middle mb-0">
                                <thead class="table-dark">
                                <tr>
                                    <th scope="col" class="fw-semibold">#</th>
                                    <th scope="col" class="fw-semibold">File Path</th>
                                </tr>
                                </thead>
                                <tbody>
                                {{- range $i, $v := $content }}
                                <tr>
                                    <th scope="row" class="text-muted">{{add $i}}</th>
                                    <td><code class="text-info">{{trimSpace $v}}</code></td>
                                </tr>
                                {{- end }}
                                </tbody>
                            </table>
                            </div>
                        </div>
                        {{- /*  Switch to assets and Close button  */}}
                        <div class="modal-footer">
                            <button class="btn btn-secondary" data-bs-dismiss="modal">‚úï Close</button>
                        </div>
                    </div>
                </div>
            </div>
            {{- end}}
            {{- /*  Artifact file download link  */}} 
            <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-auto g-3 justify-content-center">
            {{- if eq $alertURL "" }}
                {{- /*  standard download  */}}
                <div class="col">
                    <div class="d-grid" data-bs-toggle="tooltip" data-bs-title="alt + shift + d">
                        <div>
                            <a class="btn btn-success btn-lg w-100" id="artifact-download-link" href="/d/{{$download}}" rel="nofollow" role="button">üì• Download File</a>
                            <small class="d-block text-center text-muted mt-1">{{$downloadText | safeHTML}}</small>
                        </div>
                    </div>
                </div>
                {{- if eq $extraZip true }}
                <div class="col">
                    <div class="d-grid">
                        <div>
                            <a class="btn btn-outline-success btn-lg w-100" href="/jsdos/{{$download}}" rel="nofollow" role="button">üì¶ ZIP Repack</a>
                            <small class="d-block text-center text-muted mt-1">Repacked for usability</small>
                        </div>
                    </div>
                </div>{{end}}
            {{- else }}
                {{- /*  google download warning  */}}
                <div class="col">
                    <div class="d-grid">
                        <div>
                            <a class="btn btn-outline-danger btn-lg w-100" data-bs-toggle="modal" data-bs-target="#download-unwanted-modal">‚ö†Ô∏è Download</a>
                            <small class="d-block text-center text-danger mt-1">Security Warning</small>
                        </div>
                    </div>
                </div>
                <div class="modal fade" id="download-unwanted-modal" tabindex="-1" aria-labelledby="download-unwanted-modal-label" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title fs-5" id="download-unwanted-modal-label">Download warning</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body text-start">
                                Google Search or Microsoft Defender flags this download as unsafe or as an unwanted download. 
                                It maybe be a false positive, however we recommend being careful! 
                                Either run the file in a virtualized environment or in an isolated emulator.
                                <p class="m-3 text-center h6"><a class="link-offset-2" href="{{$alertURL}}">You should read this scan report before downloading</a></p>
                                <p class="m-5 text-center">
                                    <small><a class="link-secondary link-offset-3" href="/d/{{$download}}" rel="nofollow" role="button">I understand, download anyway</a></small></p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-success" data-bs-dismiss="modal">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>
            {{- end }}
            {{- if eq $jsdos6 true}}
            <div class="col">
                <div class="d-grid" data-bs-toggle="tooltip" data-bs-title="alt + shift + r">
                    <div>
                        <a href="#" id="js-dos-run-app" class="btn btn-outline-dark btn-lg w-100" data-bs-toggle="modal" data-bs-target="#js-dos-modal" rel="nofollow">üéÆ Run in Browser</a>
                        <small class="d-block text-center text-muted mt-1">Using DOSBox</small>
                    </div>
                </div>
            </div>
            {{- end}}
            </div>
            {{- /*  Additional artifact actions  */}}
            <div class="mt-4 mb-3">
                <h6 class="fw-semibold text-secondary mb-3">Additional Actions</h6>
                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-2">
            {{- if ne "" $checksum}}
                <div class="col d-none d-sm-grid">
                    <a class="btn btn-sm btn-outline-secondary text-truncate" href="/sum/{{$download}}" role="button" 
                        data-bs-toggle="tooltip" data-bs-title="{{$checksum}}" rel="nofollow">üîê Checksum</a>
                </div>
                <div class="col d-grid d-sm-none">
                    <a class="btn btn-sm btn-outline-secondary" href="/sum/{{$download}}" role="button" rel="nofollow">üîê Checksum</a>
                </div>
            {{- end}}
            {{- if $content}}
                <div class="col d-grid" data-bs-toggle="tooltip" data-bs-title="alt + shift + v">
                    <a id="artifact-view-content" class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#view-content-modal" rel="nofollow">üìã View Content</a>
                </div>
            {{- end}}
            {{- if ne "" $preview}}
                <div class="col d-grid">
                    <a class="btn btn-sm btn-outline-secondary" href="{{$preview}}" role="button" 
                        data-bs-toggle="tooltip" data-bs-title="{{$previewTip}}" rel="nofollow">üëÅÔ∏è View Artifact</a>
                </div>
            {{- end}}
                </div>
            </div>
            {{- /*  Comment on the artifact  */}}
            {{- if ne $comment ""}}
            <div class="border-start border-4 border-info ps-3 py-2 my-3">
                <p class="fst-italic mb-0">{{$comment}}</p>
            </div>
            {{- end}}
            {{- /*  Table with details  */}}
            <table class="table table-hover table-sm align-middle">
                <thead class="table-light">
                    <tr>
                        <th scope="col" class="fw-semibold">Property</th>
                        <th scope="col" class="fw-semibold">Value</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th scope="row"><span class="text-nowrap fw-semibold text-secondary">Download info</span></th>
                        <td><span data-bs-toggle="tooltip" data-bs-title="{{$filebyte}} bytes">{{$filesize}}</span>
                            {{- if ne "" $contentDesc}}, {{$contentDesc}}{{end -}}
                        </td>
                    </tr>
                    <tr>
                        <th scope="row"><span class="text-nowrap fw-semibold text-secondary">Last modification</span></th>
                        <td><span data-bs-toggle="tooltip" data-bs-title="{{$lastModAgo}}">{{$lastMod}}</span></td>
                    </tr>
                    {{- if ne $mimetype ""}}
                    <tr>
                        <th scope="row"><span class="text-nowrap fw-semibold text-secondary">Mime or file type</span></th>
                        <td>{{$mimetype}}</td>
                    </tr>
                    {{- end}}
                    {{- if $contentLatin1}}
                    <tr>
                        <th scope="row"><span class="text-nowrap fw-semibold text-secondary">Text dimensions</span></th>
                        <td><span data-bs-toggle="tooltip" data-bs-title="Number of lines in the text">{{$contentLines}}</span> x 
                            <span data-bs-toggle="tooltip" data-bs-title="Maximum number of rows or characters per-line">{{$contentRows}}</span></td>
                    </tr>
                    {{- end}}
                    {{- if $sauce}}
                    {{- if ne $sauceTitle ""}}
                    {{- if eq $editor true }}
                    <style>.selection:hover { cursor: pointer; }</style>
                    {{- end }}
                    <tr class="selection" id="artifact-embed-title">
                        <th scope="row"><span class="text-nowrap fw-semibold text-info">Embed title</span></th>
                        <td id="artifact-embed-title-value">{{$sauceTitle}}</td>
                    </tr>
                    {{- end}}{{ if ne $sauceAuthor ""}}
                    <tr class="selection" id="artifact-embed-author">
                        <th scope="row"><span class="text-nowrap fw-semibold text-info">Embed author</span></th>
                        <td id="artifact-embed-author-value">{{$sauceAuthor}}</td>
                    </tr>
                    {{- end}}{{ if ne $sauceGroup ""}}
                    <tr class="selection" id="artifact-embed-group">
                        <th scope="row"><span class="text-nowrap fw-semibold text-info">Embed group</span></th>
                        <td id="artifact-embed-group-value">{{$sauceGroup}}</td>
                    </tr>
                    {{- end}}
                    <tr>
                        <th scope="row"><span class="text-nowrap fw-semibold text-info">Embed date</span></th>
                        <td>{{$sauceDate}}</td>
                    </tr>
                    {{- end}}
                    <tr>
                        <th scope="row">&nbsp;</th>
                        <td></td>
                    </tr>
                    {{- /*  Authors and attributions  */}}
                    {{- if ne $writers "" }}
                    <tr>
                        <th scope="row"><span class="fw-semibold text-success">Writers</span></th>
                        <td>{{linkScnrs $writers}}</td>
                    </tr>{{- end}}
                    {{- if ne $artists "" }}
                    <tr>
                        <th scope="row"><span class="fw-semibold text-success">Artists</span></th>
                        <td>{{linkScnrs $artists}}</td>
                    </tr>{{- end}}
                    {{- if ne $programmers "" }}
                    <tr>
                        <th scope="row"><span class="fw-semibold text-success">Programmers</span></th>
                        <td>{{linkScnrs $programmers}}</td>
                    </tr>{{- end}}
                    {{- if ne $musicians "" }}
                    <tr>
                        <th scope="row"><span class="fw-semibold text-success">Musicians</span></th>
                        <td>{{linkScnrs $musicians}}</td>
                    </tr>{{- end}}
                    {{- /*  Pouet, Demozoo, 16colors links  */}}
                    {{- if ne $pouet ""}}
                    <tr id="pouetRow" class="d-none">
                        <th scope="row"><span class="fw-semibold text-warning">Pou√´t reviews</span></th>
                        <td>
                            <a id="pouetStars" href="https://www.pouet.net/prod.php?which={{$pouet}}">? stars</a>
                            &nbsp; <small id="pouetVotes">? votes</small>
                            <span class="d-none" id="pouetVoteID">{{$pouet}}</span>
                        </td>
                    </tr>{{- end}}
                    {{- if ne $demozoo ""}}
                    <tr>
                        <th scope="row"><span class="fw-semibold text-warning">Demozoo</span></th>
                        <td>
                            <small><a class="link-offset-3 icon-link icon-link-hover" href="https://demozoo.org/productions/{{$demozoo}}">Downloads, links and extras{{linkSVG}}</a></small>
                        </td>
                    </tr>{{- end}}
                    {{- if ne $sixteenColors ""}}
                    <tr>
                        <th scope="row">16colors</th>
                        <td>
                            <small><a class="link-offset-3 icon-link icon-link-hover" href="https://16colo.rs/{{$sixteenColors}}">Browse art and play animations{{linkSVG}}</a></small>
                        </td>
                    </tr>{{- end}}
                    {{- /*  YouTube, GitHub and other links  */}}
                    {{- if ne $youtube ""}}
                    <tr>
                        <th scope="row">YouTube</th>
                        <td>
                            <small><a class="link-offset-3 icon-link icon-link-hover" href="https://www.youtube.com/watch?v={{$youtube}}">Watch on YouTube{{linkSVG}}</a></small>
                        </td>
                    </tr>{{- end}}
                    {{- if ne $github ""}}
                    <tr>
                        <th scope="row">GitHub</th>
                        <td>
                            <small><a class="link-offset-3 icon-link icon-link-hover" href="https://github.com/{{$github}}"><var>{{$github}}</var>{{linkSVG}}</a></small>
                        </td>
                    </tr>{{- end}}
                    {{- /*  "Link to" items  */}}
                    {{- index . "websites" }}
                    {{- index . "relations" }}
                    {{- /*  File created and updated dates  */}}
                    {{- if $fileEntry}}
                    <tr>
                        <th scope="row"><small>Artifact</small></th>
                        <td><small>{{$fileEntry | safeHTML}}</small></td>
                    </tr>
                    {{- end}}
                </tbody>
            </table>
{{- end}}
