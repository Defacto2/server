/* uploader.min.js Â© Defacto2 2024 */
(()=>{function n(e){let o=document.getElementById(e);if(o==null)throw new Error(`The ${e} element is null.`);return o}function l(e){if(`${e}`=="")return!0;let o=1980,t=new Date().getFullYear();return!(e<o||e>t)}function r(e){return`${e}`==""?!0:!(e<1||e>12)}function h(e){return`${e}`==""?!0:!(e<1||e>31)}function W(e){let o=document.getElementById(e);if(o==null)throw new Error(`The ${e} element is null.`);o.addEventListener("click",function(){let t="Choose...",s=!0;_(),B.value==""&&(B.classList.add(a),s=!1),(L.value==""||L.value==t)&&(L.classList.add(a),s=!1),(x.value==""||x.value==t)&&(x.classList.add(a),s=!1),b.value==""&&(b.classList.add(a),s=!1),w.value==""&&(w.classList.add(a),s=!1),l(M.value)==!1&&(M.classList.add(a),s=!1),r(I.value)==!1&&(I.classList.add(a),s=!1),h(T.value)==!1&&(T.classList.add(a),s=!1),s==!0&&Z.submit()})}var a="is-invalid",Z=document.getElementById("advancedUploader");Z.addEventListener("reset",_);function _(){B.classList.remove(a),L.classList.remove(a),x.classList.remove(a),b.classList.remove(a),w.classList.remove(a),M.classList.remove(a),I.classList.remove(a),T.classList.remove(a)}var B=document.getElementById("advFile"),L=document.getElementById("advSelOS"),x=document.getElementById("advSelCat"),b=document.getElementById("advTitle"),w=document.getElementById("releasersAdv"),M=document.getElementById("advYear"),I=document.getElementById("advMonth"),T=document.getElementById("advDay");var $=document.getElementById("imageFile"),k=document.getElementById("imageTitle"),F=document.getElementById("imageReleasers"),S=document.getElementById("imageYear"),Y=document.getElementById("imageMonth"),ee=document.getElementById("imageUploader"),d="is-invalid";function te(){$.classList.remove(d),k.classList.remove(d),F.classList.remove(d),S.classList.remove(d),Y.classList.remove(d)}ee.addEventListener("reset",te);function oe(e){let o=document.getElementById(e);if(o==null)throw new Error(`The ${e} element is null.`);o.addEventListener("click",function(){let t=!0;te(),$.value==""&&($.classList.add(d),t=!1),k.value==""&&(k.classList.add(d),t=!1),F.value==""&&(F.classList.add(d),t=!1),l(S.value)==!1&&(S.classList.add(d),t=!1),r(Y.value)==!1&&(Y.classList.add(d),t=!1),t==!0&&ee.submit()})}var se=document.getElementById("introUploader"),R=document.getElementById("introFile"),C=document.getElementById("releaseTitle"),D=document.getElementById("introReleasers"),U=document.getElementById("introYear"),z=document.getElementById("introMonth"),c="is-invalid";function ne(){R.classList.remove(c),C.classList.remove(c),D.classList.remove(c),U.classList.remove(c),z.classList.remove(c)}se.addEventListener("reset",ne);function ae(e){let o=document.getElementById(e);if(o==null)throw new Error(`The ${e} element is null.`);o.addEventListener("click",function(){let t=!0;ne(),R.value==""&&(R.classList.add(c),t=!1),C.value==""&&(C.classList.add(c),t=!1),D.value==""&&(D.classList.add(c),t=!1),l(U.value)==!1&&(U.classList.add(c),t=!1),r(z.value)==!1&&(z.classList.add(c),t=!1),t==!0&&se.submit()})}function p(e){if(bootstrap===void 0)throw new Error("The bootstrap object is undefined.");let o=n(e);return new bootstrap.Modal(o)}function E(e,o){let t=document.getElementById(o);if(t==null)throw new Error(`The ${o} element is null.`);let s=n(e);if(s.addEventListener("shown.bs.modal",function(){t.focus()}),bootstrap===void 0)throw new Error("The bootstrap object is undefined.");return new bootstrap.Modal(s)}var ue=E("uploader-pouet","pouet-submission"),me=E("uploader-demozoo","demozoo-submission"),fe=E("uploader-intro","uploader-intro-file"),ve=p("uploaderText"),ge=p("uploaderImg"),pe=p("uploaderMag"),he=p("uploaderAdv"),Le="d",xe="p",Ee="i",ye="n",Be="g",be="m",we="a";function ie(){document.addEventListener("keydown",function(e){if(!(!e.ctrlKey||!e.altKey))switch(e.key){case Le:me.show();break;case xe:ue.show();break;case Ee:fe.show();break;case ye:ve.show();break;case Be:ge.show();break;case be:pe.show();break;case we:he.show();break}})}var j=document.getElementById("magFile"),A=document.getElementById("magTitle"),K=document.getElementById("magIssue"),q=document.getElementById("magYear"),G=document.getElementById("magMonth"),H=document.getElementById("magDay"),i="is-invalid";function Me(){j.classList.remove(i),A.classList.remove(i),K.classList.remove(i),q.classList.remove(i),G.classList.remove(i),H.classList.remove(i)}var Ie=document.getElementById("magUploader");function le(e){let o=document.getElementById(e);if(o==null)throw new Error(`The ${e} element is null.`);o.addEventListener("click",function(){let t=!0;Me(),j.value==""&&(j.classList.add(i),t=!1),A.value==""&&(A.classList.add(i),t=!1),K.value==""&&(K.classList.add(i),t=!1),l(q.value)==!1&&(q.classList.add(i),t=!1),r(G.value)==!1&&(G.classList.add(i),t=!1),h(H.value)==!1&&(H.classList.add(i),t=!1),t==!0&&Ie.submit()})}function re(e,o){let t=document.getElementById(e);if(t==null)throw new Error(`The ${e} element is null.`);let s=document.getElementById(o);if(s==null)throw new Error(`The ${o} form element is null.`);s.addEventListener("reset",de),t.addEventListener("click",function(){Te()==!0&&s.submit()})}var O=n("textFile"),P=n("textTitle"),X=n("textReleasers"),J=n("textYear"),N=n("textMonth"),u="is-invalid";function de(){O.classList.remove(u),P.classList.remove(u),X.classList.remove(u),J.classList.remove(u),N.classList.remove(u)}function Te(){let e=!0;return de(),O.value==""&&(O.classList.add(u),e=!1),P.value==""&&(P.classList.add(u),e=!1),X.value==""&&(X.classList.add(u),e=!1),l(J.value)==!1&&(J.classList.add(u),e=!1),r(N.value)==!1&&(N.classList.add(u),e=!1),e}var v="d-none";function Q(e,o,t){let s=n(e),m=n(`${e}-error`),y=n(`${e}-results`);n(`${e}-close`).addEventListener("click",V),n(`${e}-clear`).addEventListener("click",V);function V(){s.value="",s.focus(),m.innerText="",m.classList.add(v),y.innerHTML=""}n(o).addEventListener("change",function(){let f=this.files[0],g=document.getElementById("search-results");f.size>10485760&&(g.innerText="File is too big, maximum size is 10MB.",this.value="")}),document.body.addEventListener("htmx:beforeRequest",function(){$e(m,y)}),document.body.addEventListener("htmx:afterRequest",function(f){if(f.detail.elt===null||f.detail.elt.id!==`${e}`)return;if(f.detail.successful)return ke(m);let g=f.detail.xhr;if(f.detail.failed&&g)return g.status===404?Fe(m,y,t):Ye(m,g);Se(m)})}function $e(e,o){o.innerHTML="",e.innerText="",e.classList.add(v)}function ke(e){e.classList.add(v),e.innerText=""}function Fe(e,o,t){o.innerText=`Production not found on ${t}.`,e.classList.add(v),e.innerText=""}function Se(e){e.innerText="Something with the browser is not working, please refresh the page.",e.classList.remove(v)}function Ye(e,o){e.innerText=`Something went wrong, ${o.status} status: ${o.responseText}.`,e.classList.remove(v)}var ce=Re;function Re(){console.log("htmx: load event loaded"),document.body.addEventListener("htmx:load",function(){console.log("htmx:load event fired"),htmx.on("#uploader-intro-form","htmx:xhr:progress",function(e){console.log("htmx:xhr:progress event fired"),htmx.find("#uploader-intro-progress").setAttribute("value",e.detail.loaded/e.detail.total*100)})})}(()=>{"use strict";ie(),W("advSubmit"),oe("imageSubmit"),ae("introSubmit"),le("magSubmit"),re("textSubmit","textUploader"),Q("demozoo-submission","uploader-intro-file","Demozoo"),Q("pouet-submission","uploader-intro-file","Pou\xEBt"),ce()})();})();
