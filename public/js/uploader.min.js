/* uploader.min.js Â© Defacto2 2024 */
(()=>{function t(e){let a=document.getElementById(e);if(a==null){console.error(`The ${e} for getElmById() element is null.`);return}return a}function i(e){if(`${e}`=="")return!0;let a=1980,r=new Date().getFullYear();return!(e<a||e>r)}function o(e){return`${e}`==""?!0:!(e<1||e>12)}function ce(e){return`${e}`==""?!0:!(e<1||e>31)}function Ce(e,a){if(e=="")return!0;let r=Number(e),s=Number(a);if(!Number.isInteger(s)||s<1)throw new Error(`The ID sanity value is invalid: ${s}`);return Number.isInteger(r)&&r>0&&r<=s}var l="is-invalid",M="d-none",bt=100,ye=1024*1024,He=100*ye;function k(e,a){if(e==null)throw new Error("The elementId value of focusModalById is null.");if(a==null)throw new Error("The submissionId value of focusModalById is null.");let r=document.getElementById(a);if(r==null)throw new Error(`The ${a} element is null.`);let s=t(e);if(s.addEventListener("shown.bs.modal",function(){r.focus()}),bootstrap===void 0)throw new Error("The bootstrap object is undefined.");return new bootstrap.Modal(s,{keyboard:!0})}async function wt(e){if(e==null)throw new Error("The file value of checkSHA is null.");let a=await yt(e),r=await fetch(`/uploader/sha384/${a}`,{method:"PATCH",headers:{"Content-Type":"text/plain"},body:a});if(!r.ok)throw new Error(`Hashing is not possible, server response: ${r.status}`);return await r.text()}async function yt(e){if(e==null)throw new Error("The file value of sha384 is null.");try{let a=await e.arrayBuffer(),r=await crypto.subtle.digest("SHA-384",a);return Array.from(new Uint8Array(r)).map(s=>s.toString(16).padStart(2,"0")).join("")}catch(a){throw new Error(`Could not use arrayBuffer or crypto.subtle: ${a}`)}}function H(e,a){if(e==null)throw new Error("The formId value of progress is null.");if(a==null)throw new Error("The elementId value of progress is null.");htmx.on(`#${e}`,"htmx:xhr:progress",function(r){r.target.id==`${e}`&&htmx.find(`#${a}`).setAttribute("value",r.detail.loaded/r.detail.total*bt)})}function u(e){if(e==null)throw new Error("The file value of checkSize is null.");return e.size>He?`The chosen file is too big at ${Math.round(e.size/ye)}MB, maximum size is ${He/ye}MB.`:""}function Fe(){return ce(this.value)==!1?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function d(){return console.log(`The month value is ${this.value}.`),o(this.value)==!1?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function p(){return i(this.value)==!1?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function f(e,a,r,s){if(e==null)throw new Error("The errors value of checkErrors is null.");if(a==null)throw new Error("The alert value of checkErrors is null.");if(r==null)throw new Error("The fileInput value of checkErrors is null.");if(s==null)throw new Error("The results value of checkErrors is null.");e=e.filter(g=>g!=""),!(e.length<=0)&&(a.innerText=e.join(" "),a.classList.remove(M),r.innerText="",r.classList.add(l),s.classList.add(M))}async function m(e,a,r,s){if(e==null)throw new Error("The file value of checkDuplicate is null.");if(a==null)throw new Error("The alert value of checkDuplicate is null.");if(r==null)throw new Error("The fileInput value of checkDuplicate is null.");if(s==null)throw new Error("The results value of checkDuplicate is null.");let g=()=>{a.classList.remove(M),r.innerText="",r.classList.add(l),s.classList.add(M)},Q="";try{let E=await wt(e);if(E==""){a.innerText="";return}Q=E}catch(E){console.log(`${E}`),a.innerText=`${E}`,g();return}a.innerText="The chosen file already exists in the database: ";let ee=document.createElement("a");ee.href=`/f/${Q}`,ee.innerText=`${e.name}`,a.appendChild(ee),g()}function h(e,a,r){if(e==null)throw new Error("The file1 value of hiddenDetails is null.");if(a==null)throw new Error("The lastMod value of hiddenDetails is null.");if(r==null)throw new Error("The magic value of hiddenDetails is null.");let s=e.lastModified,g=new Date().getTime(),Q=60*60*1e3;g-s<Q||(a.value=s),e.type!=""&&(r.value=e.type)}function c(){return this.value==""?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function Ae(){return this.value==""?(this.classList.remove(l),!0):new RegExp(/^[a-zA-Z0-9_-]{11}$/).test(this.value)==!1?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function v(e,a,r){if(e==null)throw new Error("The fileInput value of resetInput is null.");if(a==null)throw new Error("The alert value of resetInput is null.");if(r==null)throw new Error("The results value of resetInput is null.");e.innerText="",e.classList.remove(l),a.innerText="",a.classList.add(M),r.innerText="",r.classList.add(M)}function L(e,a){if(e==null)throw new Error("The alert value of submitError is null.");if(a==null)throw new Error("The results value of submitError is null.");e.innerText="Please correct the problems with the form.",e.classList.remove(M),a.innerText="",a.classList.add(M)}var xt=k("uploader-pouet-modal","pouet-submission"),kt=k("uploader-demozoo-modal","demozoo-submission"),Tt=k("uploader-intro-modal","uploader-intro-file"),Et=k("uploader-trainer-modal","uploader-trainer-file"),Mt=k("uploader-text-modal","uploader-text-file"),zt=k("uploader-image-modal","uploader-image-file"),It=k("uploader-magazine-modal","uploader-magazine-file"),$t=k("uploader-advanced-modal","uploader-advanced-file"),Dt="d",Bt="p",St="i",Ct="t",Ht="n",Ft="g",At="m",Yt="a",jt="r",Vt="f",Pt="x";function Ye(){document.addEventListener("keydown",function(e){if(!(!e.ctrlKey||!e.altKey))switch(e.key){case Dt:kt.show();break;case Bt:xt.show();break;case St:Tt.show();break;case Ct:Et.show();break;case Ht:Mt.show();break;case Ft:zt.show();break;case At:It.show();break;case Yt:$t.show();break;case jt:e.preventDefault(),window.location.href="/search/releaser";break;case Vt:e.preventDefault(),window.location.href="/search/file";break;case Pt:e.preventDefault(),window.location.href="/search/desc";break}})}var xe="is-invalid",te="d-none";function ke(e,a){let r=t(e),s=t(`${e}-error`),g=t(`${e}-results`);t(`${e}-close`).addEventListener("click",E),t(`${e}-clear`).addEventListener("click",E);function E(){r.value="",r.focus(),r.classList.remove(xe),s.innerText="",s.classList.add(te),g.innerHTML=""}let Lt=45e4,gt=2e5;switch(e){case"demozoo-submission":je(r,Lt);break;case"pouet-submission":je(r,gt);break}document.body.addEventListener("htmx:beforeRequest",function(){qt(s,g)}),document.body.addEventListener("htmx:beforeSwap",function(C){C.detail.xhr.status>=400&&s.classList.remove(te)}),document.body.addEventListener("htmx:afterRequest",function(C){if(C.detail.elt===null||C.detail.elt.id!==`${e}`)return;if(C.detail.successful)return Rt(r);let le=C.detail.xhr;if(C.detail.failed&&le)return le.status===404?Nt(s,g,a):Kt(s,le);Ut(s)})}function je(e,a){e.addEventListener("input",function(){if(!Ce(e.value,a)){e.classList.add(xe);return}e.classList.remove(xe)})}function qt(e,a){a.innerHTML="",e.innerText="",e.classList.add(te)}function Rt(e){e.focus()}function Nt(e,a,r){a.innerText=`Production not found on ${r}.`}function Ut(e){e.innerText="Something with the browser is not working, please refresh the page.",e.classList.remove(te)}function Kt(e,a){e.innerText=`Something went wrong, ${a.status} status: ${a.responseText}.`,e.classList.remove(te)}var Gt="application/x-freearc",Xt="application/x-arj",Ot="application/x-bzip",Wt="application/x-bzip2",Zt="application/gzip",_t="application/vnd.rar",Jt="application/x-tar",Qt="application/zip",er="application/x-7z-compressed",tr="application/x-msdos-program",rr="image/bmp",ar="image/gif",sr="image/jpeg",nr="image/vnd.zbrush.pcx",ir="image/png",or="image/tiff",lr="image/webp",cr="application/x-csh",ur="application/x-chrome-extension",dr="text/x-script.perl",pr="application/x-httpd-php",fr="text/x-script.phyton",mr="text/x-script.rexx",hr="application/x-sh",vr="application/x-shellscript",Lr="text/x-script.tcl",gr="text/x-shellscript",br="text/x-script.zsh";function wr(){return[cr,ur,dr,pr,fr,mr,hr,vr,Lr,gr,br]}function Ve(){return[tr]}function ue(){return[Gt,Xt,Ot,Wt,Zt,_t,Jt,Qt,er]}function Pe(){return["application/octet-stream","application/x-binary","application/x-ms-dos-executable"]}function yr(){return[rr,ar,sr,nr,ir,or,lr]}function qe(){return["text/plain","text/x-nfo"]}function Re(e){return wr().includes(e)}function Ne(e){return yr().concat(ue()).includes(e)}function de(e){return Ve().concat(ue(),Pe()).includes(e)}function Ue(e){return qe().concat(ue(),Ve(),Pe()).includes(e)}function Ke(e){return qe().concat(ue()).includes(e)}var xr="uploader-image-form",T="is-invalid",Te="d-none",kr=t(xr),R=t("uploader-image-alert"),F=t("uploader-image-file"),Ge=t("uploader-image-last-modified"),Tr=t("uploader-image-list-1"),Er=t("uploader-image-list-2"),Xe=t("uploader-image-magic"),re=t("uploader-image-month"),pe=t("uploader-image-releaser-1"),z=t("uploader-image-results"),q=t("uploader-image-year");kr.addEventListener("reset",function(){Ge.value="",Xe.value="",We()});F.addEventListener("change",Mr);pe.addEventListener("input",c);q.addEventListener("input",p);re.addEventListener("input",d);function Oe(e){t(e).addEventListener("click",function(){let r=!0;if(pe.value==""&&(pe.classList.add(T),r=!1),i(q.value)==!1&&(q.classList.add(T),r=!1),o(re.value)==!1&&(re.classList.add(T),r=!1),re.value!=""&&q.value==""&&(q.classList.add(T),r=!1),F.value==""&&(F.classList.add(T),r=!1),r==!1)return L(R,z);We(),z.innerText="...",z.classList.remove(Te)})}async function Mr(){v(F,R,z);let e=this.files[0],a=[u(e),zr(e)];f(a,R,F,z),m(e,R,F,z),h(e,Ge,Xe)}function zr(e){return Ne(e.type)?"":`The chosen file mime type ${e.type} might not be suitable for an image.`}function We(){Tr.innerHTML="",Er.innerHTML="",z.innerHTML="",z.classList.add(Te),R.innerText="",R.classList.add(Te),q.classList.remove(T),re.classList.remove(T),pe.classList.remove(T),F.classList.remove(T)}var Ir="uploader-intro-form",x="is-invalid",Ee="d-none",$r=t(Ir),U=t("uploader-intro-alert"),A=t("uploader-intro-file"),Ze=t("uploader-intro-last-modified"),Dr=t("uploader-intro-list-1"),Br=t("uploader-intro-list-2"),_e=t("uploader-intro-magic"),ae=t("uploader-intro-month"),fe=t("uploader-intro-releaser-1"),I=t("uploader-intro-results"),N=t("uploader-intro-year"),Je=t("uploader-intro-youtube");$r.addEventListener("reset",function(){Ze.value="",_e.value="",et()});A.addEventListener("change",Sr);fe.addEventListener("input",c);N.addEventListener("input",p);ae.addEventListener("input",d);Je.addEventListener("input",Ae);function Qe(e){t(e).addEventListener("click",function(){let r=!0;if(fe.value==""&&(fe.classList.add(x),r=!1),i(N.value)==!1&&(N.classList.add(x),r=!1),o(ae.value)==!1&&(ae.classList.add(x),r=!1),ae.value!=""&&N.value==""&&(N.classList.add(x),r=!1),A.value==""&&(A.classList.add(x),r=!1),r==!1)return L(U,I);et(),I.innerText="...",I.classList.remove(Ee)})}async function Sr(){v(A,U,I);let e=this.files[0],a=[u(e),Cr(e)];f(a,U,A,I),m(e,U,A,I),h(e,Ze,_e)}function Cr(e){return de(e.type)?"":`The chosen file mime type ${e.type} might not be suitable for an intro.`}function et(){Dr.innerHTML="",Br.innerHTML="",I.innerHTML="",I.classList.add(Ee),U.innerText="",U.classList.add(Ee),N.classList.remove(x),ae.classList.remove(x),fe.classList.remove(x),Je.classList.remove(x),A.classList.remove(x)}var Hr="uploader-magazine-form",b="is-invalid",Me="d-none",Fr=t(Hr),G=t("uploader-magazine-alert"),Y=t("uploader-magazine-file"),tt=t("uploader-magazine-last-modified"),Ar=t("uploader-magazine-list-1"),rt=t("uploader-magazine-magic"),se=t("uploader-magazine-month"),me=t("uploader-magazine-releaser-1"),$=t("uploader-magazine-results"),ze=t("uploader-magazine-title"),K=t("uploader-magazine-year");Fr.addEventListener("reset",function(){tt.value="",rt.value="",st()});Y.addEventListener("change",Yr);me.addEventListener("input",c);K.addEventListener("input",p);se.addEventListener("input",d);function at(e){t(e).addEventListener("click",function(){let r=!0;if(ze.value==""&&(ze.classList.add(b),r=!1),me.value==""&&(me.classList.add(b),r=!1),i(K.value)==!1&&(K.classList.add(b),r=!1),o(se.value)==!1&&(se.classList.add(b),r=!1),se.value!=""&&K.value==""&&(K.classList.add(b),r=!1),Y.value==""&&(Y.classList.add(b),r=!1),r==!1)return L(G,$);st(),$.innerText="...",$.classList.remove(Me)})}async function Yr(){v(Y,G,$);let e=this.files[0],a=[u(e),jr(e)];f(a,G,Y,$),m(e,G,Y,$),h(e,tt,rt)}function jr(e){return Ue(e.type)?"":`The chosen file mime type ${e.type} might not be suitable for an image.`}function st(){Ar.innerHTML="",$.innerHTML="",$.classList.add(Me),G.innerText="",G.classList.add(Me),K.classList.remove(b),se.classList.remove(b),me.classList.remove(b),Y.classList.remove(b),ze.classList.remove(b)}var Vr="uploader-text-form",w="is-invalid",Ie="d-none",Pr=t(Vr),O=t("uploader-text-alert"),j=t("uploader-text-file"),nt=t("uploader-text-last-modified"),qr=t("uploader-text-list-1"),Rr=t("uploader-text-list-2"),it=t("uploader-text-magic"),ne=t("uploader-text-month"),he=t("uploader-text-releaser-1"),D=t("uploader-text-results"),$e=t("uploader-text-title"),X=t("uploader-text-year");Pr.addEventListener("reset",function(){nt.value="",it.value="",lt()});j.addEventListener("change",Nr);he.addEventListener("input",c);X.addEventListener("input",p);ne.addEventListener("input",d);function ot(e){t(e).addEventListener("click",function(){let r=!0;if($e.value==""&&($e.classList.add(w),r=!1),he.value==""&&(he.classList.add(w),r=!1),i(X.value)==!1&&(X.classList.add(w),r=!1),o(ne.value)==!1&&(ne.classList.add(w),r=!1),ne.value!=""&&X.value==""&&(X.classList.add(w),r=!1),j.value==""&&(j.classList.add(w),r=!1),r==!1)return L(O,D);lt(),D.innerText="...",D.classList.remove(Ie)})}async function Nr(){v(j,O,D);let e=this.files[0],a=[u(e),Ur(e)];f(a,O,j,D),m(e,O,j,D),h(e,nt,it)}function Ur(e){return Ke(e.type)?"":`The chosen file mime type ${e.type} might not be suitable for a text.`}function lt(){qr.innerHTML="",Rr.innerHTML="",D.innerHTML="",D.classList.add(Ie),O.innerText="",O.classList.add(Ie),X.classList.remove(w),ne.classList.remove(w),he.classList.remove(w),j.classList.remove(w),$e.classList.remove(w)}var Kr="uploader-trainer-form",y="is-invalid",De="d-none",Gr=t(Kr),Z=t("uploader-trainer-alert"),V=t("uploader-trainer-file"),ct=t("uploader-trainer-last-modified"),Xr=t("uploader-trainer-list-1"),Or=t("uploader-trainer-list-2"),ut=t("uploader-trainer-magic"),ie=t("uploader-trainer-month"),ve=t("uploader-trainer-releaser-1"),B=t("uploader-trainer-results"),Be=t("uploader-trainer-title"),W=t("uploader-trainer-year");Gr.addEventListener("reset",function(){ct.value="",ut.value="",pt()});V.addEventListener("change",Wr);ve.addEventListener("input",c);W.addEventListener("input",p);ie.addEventListener("input",d);function dt(e){t(e).addEventListener("click",function(){let r=!0;if(Be.value==""&&(Be.classList.add(y),r=!1),ve.value==""&&(ve.classList.add(y),r=!1),i(W.value)==!1&&(W.classList.add(y),r=!1),o(ie.value)==!1&&(ie.classList.add(y),r=!1),ie.value!=""&&W.value==""&&(W.classList.add(y),r=!1),V.value==""&&(V.classList.add(y),r=!1),r==!1)return L(Z,B);pt(),B.innerText="...",B.classList.remove(De)})}async function Wr(){v(V,Z,B);let e=this.files[0],a=[u(e),Zr(e)];f(a,Z,V,B),m(e,Z,V,B),h(e,ct,ut)}function Zr(e){return de(e.type)?"":`The chosen file mime type ${e.type} might not be suitable for an intro.`}function pt(){Xr.innerHTML="",Or.innerHTML="",B.innerHTML="",B.classList.add(De),Z.innerText="",Z.classList.add(De),W.classList.remove(y),ie.classList.remove(y),ve.classList.remove(y),V.classList.remove(y),Be.classList.remove(y)}var _r="uploader-advanced-form",n="is-invalid",Se="d-none",Jr=t(_r),J=t("uploader-advanced-alert"),Le=t("uploader-advanced-category"),Qr=t("uploader-advanced-classification-help"),ge=t("uploader-advanced-day"),P=t("uploader-advanced-file"),ft=t("uploader-advanced-last-modified"),ea=t("uploader-advanced-list-1"),ta=t("uploader-advanced-list-2"),mt=t("uploader-advanced-magic"),oe=t("uploader-advanced-month"),be=t("uploader-advanced-operating-system"),we=t("uploader-advanced-releaser-1"),S=t("uploader-advanced-results"),_=t("uploader-advanced-year");Jr.addEventListener("reset",function(){ft.value="",mt.value="",vt()});P.addEventListener("change",ra);we.addEventListener("input",c);_.addEventListener("input",p);oe.addEventListener("input",d);ge.addEventListener("input",Fe);Le.addEventListener("change",c);be.addEventListener("change",c);function ht(e){t(e).addEventListener("click",function(){let r=!0;if(we.value==""&&(we.classList.add(n),r=!1),i(_.value)==!1&&(_.classList.add(n),r=!1),o(oe.value)==!1&&(oe.classList.add(n),r=!1),ce(ge.value)==!1&&(ge.classList.add(n),r=!1),oe.value!=""&&_.value==""&&(_.classList.add(n),r=!1),P.value==""&&(P.classList.add(n),r=!1),be.value==""&&(be.classList.add(n),r=!1),Le.value==""&&(Le.classList.add(n),r=!1),r==!1)return L(J,S);vt(),S.innerText="...",S.classList.remove(Se)})}async function ra(){v(P,J,S);let e=this.files[0],a=[u(e),aa(e)];f(a,J,P,S),m(e,J,P,S),h(e,ft,mt)}function aa(e){return Re(e.type)?`The chosen file mime type ${e.type} might not be suitable for an upload.`:""}function vt(){ea.innerHTML="",ta.innerHTML="",S.innerHTML="",Qr.innerHTML="",S.classList.add(Se),J.innerText="",J.classList.add(Se),_.classList.remove(n),oe.classList.remove(n),ge.classList.remove(n),we.classList.remove(n),P.classList.remove(n),be.classList.remove(n),Le.classList.remove(n)}(()=>{"use strict";Ye(),ke("demozoo-submission","Demozoo"),ke("pouet-submission","Pou\xEBt"),Oe("uploader-image-submit"),H("uploader-image-form","uploader-image-progress"),Qe("uploader-intro-submit"),H("uploader-intro-form","uploader-intro-progress"),dt("uploader-trainer-submit"),H("uploader-trainer-form","uploader-trainer-progress"),at("uploader-magazine-submit"),H("uploader-magazine-form","uploader-magazine-progress"),ot("uploader-text-submit"),H("uploader-text-form","uploader-text-progress"),ht("uploader-advanced-submit"),H("uploader-advanced-form","uploader-advanced-progress")})();})();
