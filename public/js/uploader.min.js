/* uploader.min.js Â© Defacto2 2024 */
(()=>{function t(e){let a=document.getElementById(e);if(a==null)throw new Error(`The ${e} element is null.`);return a}function n(e){if(`${e}`=="")return!0;let a=1980,r=new Date().getFullYear();return!(e<a||e>r)}function o(e){return`${e}`==""?!0:!(e<1||e>12)}function ie(e){return`${e}`==""?!0:!(e<1||e>31)}function Ie(e,a){if(e=="")return!0;let r=Number(e),s=Number(a);if(!Number.isInteger(s)||s<1)throw new Error(`The ID sanity value is invalid: ${s}`);return Number.isInteger(r)&&r>0&&r<=s}var l="is-invalid",k="d-none",vt=100,xe=1024*1024,Be=100*xe;function y(e,a){if(e==null)throw new Error("The elementId value of focusModalById is null.");if(a==null)throw new Error("The submissionId value of focusModalById is null.");let r=document.getElementById(a);if(r==null)throw new Error(`The ${a} element is null.`);let s=t(e);if(s.addEventListener("shown.bs.modal",function(){r.focus()}),bootstrap===void 0)throw new Error("The bootstrap object is undefined.");return new bootstrap.Modal(s,{keyboard:!0})}async function Lt(e){if(e==null)throw new Error("The file value of checkSHA is null.");try{let a=await xt(e),r=await fetch(`/uploader/sha384/${a}`,{method:"PUT",headers:{"Content-Type":"text/plain"},body:a});if(!r.ok)throw new Error(`Hashing is not possible, server response: ${r.status}`);return await r.text()=="true"}catch(a){console.log(`Hashing is not possible: ${a}`)}}async function xt(e){if(e==null)throw new Error("The file value of sha384 is null.");try{let a=await e.arrayBuffer(),r=await crypto.subtle.digest("SHA-384",a);return Array.from(new Uint8Array(r)).map(s=>s.toString(16).padStart(2,"0")).join("")}catch(a){throw new Error(`Could not use arrayBuffer or crypto.subtle: ${a}`)}}function S(e,a){if(e==null)throw new Error("The formId value of progress is null.");if(a==null)throw new Error("The elementId value of progress is null.");htmx.on(`#${e}`,"htmx:xhr:progress",function(r){r.target.id==`${e}`&&htmx.find(`#${a}`).setAttribute("value",r.detail.loaded/r.detail.total*vt)})}function u(e){if(e==null)throw new Error("The file value of checkSize is null.");return e.size>Be?`The chosen file is too big at ${Math.round(e.size/xe)}MB, maximum size is ${Be/xe}MB.`:""}function De(){return ie(this.value)==!1?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function d(){return console.log(`The month value is ${this.value}.`),o(this.value)==!1?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function f(){return n(this.value)==!1?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function p(e,a,r,s){if(e==null)throw new Error("The errors value of checkErrors is null.");if(a==null)throw new Error("The alert value of checkErrors is null.");if(r==null)throw new Error("The fileInput value of checkErrors is null.");if(s==null)throw new Error("The results value of checkErrors is null.");e=e.filter(g=>g!=""),!(e.length<=0)&&(a.innerText=e.join(" "),a.classList.remove(k),r.innerText="",r.classList.add(l),s.classList.add(k))}async function m(e,a,r,s){if(e==null)throw new Error("The file value of checkDuplicate is null.");if(a==null)throw new Error("The alert value of checkDuplicate is null.");if(r==null)throw new Error("The fileInput value of checkDuplicate is null.");if(s==null)throw new Error("The results value of checkDuplicate is null.");await Lt(e)!=!1&&(a.innerText=`The chosen file already exists in the database: ${e.name}`,a.classList.remove(k),r.innerText="",r.classList.add(l),s.classList.add(k))}function h(e,a,r){if(e==null)throw new Error("The file1 value of hiddenDetails is null.");if(a==null)throw new Error("The lastMod value of hiddenDetails is null.");if(r==null)throw new Error("The magic value of hiddenDetails is null.");let s=e.lastModified,g=new Date().getTime(),ze=60*60*1e3;g-s<ze||(a.value=s),e.type!=""&&(r.value=e.type)}function c(){return this.value==""?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function Se(){return this.value==""?(this.classList.remove(l),!0):new RegExp(/^[a-zA-Z0-9_-]{11}$/).test(this.value)==!1?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function v(e,a,r){if(e==null)throw new Error("The fileInput value of resetInput is null.");if(a==null)throw new Error("The alert value of resetInput is null.");if(r==null)throw new Error("The results value of resetInput is null.");e.innerText="",e.classList.remove(l),a.innerText="",a.classList.add(k),r.innerText="",r.classList.add(k)}function L(e,a){if(e==null)throw new Error("The alert value of submitError is null.");if(a==null)throw new Error("The results value of submitError is null.");e.innerText="Please correct the problems with the form.",e.classList.remove(k),a.innerText="",a.classList.add(k)}var gt=y("uploader-pouet-modal","pouet-submission"),yt=y("uploader-demozoo-modal","demozoo-submission"),bt=y("uploader-intro-modal","uploader-intro-file"),Tt=y("uploader-trainer-modal","uploader-trainer-file"),wt=y("uploader-text-modal","uploader-text-file"),Et=y("uploader-image-modal","uploader-image-file"),kt=y("uploader-magazine-modal","uploader-magazine-file"),Mt=y("uploader-advanced-modal","uploader-advanced-file"),zt="d",$t="p",It="i",Bt="t",Dt="n",St="g",Ht="m",Yt="a";function He(){document.addEventListener("keydown",function(e){if(!(!e.ctrlKey||!e.altKey))switch(e.key){case zt:yt.show();break;case $t:gt.show();break;case It:bt.show();break;case Bt:Tt.show();break;case Dt:wt.show();break;case St:Et.show();break;case Ht:kt.show();break;case Yt:Mt.show();break}})}var ge="is-invalid",V="d-none";function ye(e,a){let r=t(e),s=t(`${e}-error`),g=t(`${e}-results`);t(`${e}-close`).addEventListener("click",$e),t(`${e}-clear`).addEventListener("click",$e);function $e(){r.value="",r.focus(),r.classList.remove(ge),s.innerText="",s.classList.add(V),g.innerHTML=""}let mt=45e4,ht=2e5;switch(e){case"demozoo-submission":Ye(r,mt);break;case"pouet-submission":Ye(r,ht);break}document.body.addEventListener("htmx:beforeRequest",function(){Ft(s,g)}),document.body.addEventListener("htmx:afterRequest",function(Q){if(Q.detail.elt===null||Q.detail.elt.id!==`${e}`)return;if(Q.detail.successful)return jt(s);let Le=Q.detail.xhr;if(Q.detail.failed&&Le)return Le.status===404?At(s,g,a):Vt(s,Le);Ct(s)})}function Ye(e,a){e.addEventListener("input",function(){if(!Ie(e.value,a)){e.classList.add(ge);return}e.classList.remove(ge)})}function Ft(e,a){a.innerHTML="",e.innerText="",e.classList.add(V)}function jt(e){e.classList.add(V),e.innerText=""}function At(e,a,r){a.innerText=`Production not found on ${r}.`,e.classList.add(V),e.innerText=""}function Ct(e){e.innerText="Something with the browser is not working, please refresh the page.",e.classList.remove(V)}function Vt(e,a){e.innerText=`Something went wrong, ${a.status} status: ${a.responseText}.`,e.classList.remove(V)}var Rt="application/x-freearc",Nt="application/x-arj",Pt="application/x-bzip",Kt="application/x-bzip2",qt="application/gzip",Gt="application/vnd.rar",Ot="application/x-tar",Ut="application/zip",Xt="application/x-7z-compressed",Zt="application/x-msdos-program",_t="image/bmp",Jt="image/gif",Qt="image/jpeg",Wt="image/vnd.zbrush.pcx",er="image/png",tr="image/tiff",rr="image/webp",ar="application/x-csh",sr="application/x-chrome-extension",ir="text/x-script.perl",nr="application/x-httpd-php",or="text/x-script.phyton",lr="text/x-script.rexx",cr="application/x-sh",ur="application/x-shellscript",dr="text/x-script.tcl",fr="text/x-shellscript",pr="text/x-script.zsh";function mr(){return[ar,sr,ir,nr,or,lr,cr,ur,dr,fr,pr]}function Fe(){return[Zt]}function ne(){return[Rt,Nt,Pt,Kt,qt,Gt,Ot,Ut,Xt]}function je(){return["application/octet-stream","application/x-binary","application/x-ms-dos-executable"]}function hr(){return[_t,Jt,Qt,Wt,er,tr,rr]}function Ae(){return["text/plain","text/x-nfo"]}function Ce(e){return mr().includes(e)}function Ve(e){return hr().concat(ne()).includes(e)}function oe(e){return Fe().concat(ne(),je()).includes(e)}function Re(e){return Ae().concat(ne(),Fe(),je()).includes(e)}function Ne(e){return Ae().concat(ne()).includes(e)}var vr="uploader-image-form",b="is-invalid",be="d-none",Lr=t(vr),N=t("uploader-image-alert"),H=t("uploader-image-file"),Pe=t("uploader-image-last-modified"),xr=t("uploader-image-list-1"),gr=t("uploader-image-list-2"),Ke=t("uploader-image-magic"),W=t("uploader-image-month"),le=t("uploader-image-releaser-1"),M=t("uploader-image-results"),R=t("uploader-image-year");Lr.addEventListener("reset",function(){Pe.value="",Ke.value="",Ge()});H.addEventListener("change",yr);le.addEventListener("input",c);R.addEventListener("input",f);W.addEventListener("input",d);function qe(e){t(e).addEventListener("click",function(){let r=!0;if(le.value==""&&(le.classList.add(b),r=!1),n(R.value)==!1&&(R.classList.add(b),r=!1),o(W.value)==!1&&(W.classList.add(b),r=!1),W.value!=""&&R.value==""&&(R.classList.add(b),r=!1),H.value==""&&(H.classList.add(b),r=!1),r==!1)return L(N,M);Ge(),M.innerText="...",M.classList.remove(be)})}async function yr(){v(H,N,M);let e=this.files[0],a=[u(e),br(e)];p(a,N,H,M),m(e,N,H,M),h(e,Pe,Ke)}function br(e){return Ve(e.type)?"":`The chosen file mime type ${e.type} is probably not suitable for an image.`}function Ge(){xr.innerHTML="",gr.innerHTML="",M.innerHTML="",M.classList.add(be),N.innerText="",N.classList.add(be),R.classList.remove(b),W.classList.remove(b),le.classList.remove(b),H.classList.remove(b)}var Tr="uploader-intro-form",x="is-invalid",Te="d-none",wr=t(Tr),K=t("uploader-intro-alert"),Y=t("uploader-intro-file"),Oe=t("uploader-intro-last-modified"),Er=t("uploader-intro-list-1"),kr=t("uploader-intro-list-2"),Ue=t("uploader-intro-magic"),ee=t("uploader-intro-month"),ce=t("uploader-intro-releaser-1"),z=t("uploader-intro-results"),P=t("uploader-intro-year"),Xe=t("uploader-intro-youtube");wr.addEventListener("reset",function(){Oe.value="",Ue.value="",_e()});Y.addEventListener("change",Mr);ce.addEventListener("input",c);P.addEventListener("input",f);ee.addEventListener("input",d);Xe.addEventListener("input",Se);function Ze(e){t(e).addEventListener("click",function(){let r=!0;if(ce.value==""&&(ce.classList.add(x),r=!1),n(P.value)==!1&&(P.classList.add(x),r=!1),o(ee.value)==!1&&(ee.classList.add(x),r=!1),ee.value!=""&&P.value==""&&(P.classList.add(x),r=!1),Y.value==""&&(Y.classList.add(x),r=!1),r==!1)return L(K,z);_e(),z.innerText="...",z.classList.remove(Te)})}async function Mr(){v(Y,K,z);let e=this.files[0],a=[u(e),zr(e)];p(a,K,Y,z),m(e,K,Y,z),h(e,Oe,Ue)}function zr(e){return oe(e.type)?"":`The chosen file mime type ${e.type} is probably not suitable for an intro.`}function _e(){Er.innerHTML="",kr.innerHTML="",z.innerHTML="",z.classList.add(Te),K.innerText="",K.classList.add(Te),P.classList.remove(x),ee.classList.remove(x),ce.classList.remove(x),Xe.classList.remove(x),Y.classList.remove(x)}var $r="uploader-magazine-form",T="is-invalid",we="d-none",Ir=t($r),G=t("uploader-magazine-alert"),F=t("uploader-magazine-file"),Je=t("uploader-magazine-last-modified"),Br=t("uploader-magazine-list-1"),Qe=t("uploader-magazine-magic"),te=t("uploader-magazine-month"),ue=t("uploader-magazine-releaser-1"),$=t("uploader-magazine-results"),q=t("uploader-magazine-year");Ir.addEventListener("reset",function(){Je.value="",Qe.value="",et()});F.addEventListener("change",Dr);ue.addEventListener("input",c);q.addEventListener("input",f);te.addEventListener("input",d);function We(e){t(e).addEventListener("click",function(){let r=!0;if(ue.value==""&&(ue.classList.add(T),r=!1),n(q.value)==!1&&(q.classList.add(T),r=!1),o(te.value)==!1&&(te.classList.add(T),r=!1),te.value!=""&&q.value==""&&(q.classList.add(T),r=!1),F.value==""&&(F.classList.add(T),r=!1),r==!1)return L(G,$);et(),$.innerText="...",$.classList.remove(we)})}async function Dr(){v(F,G,$);let e=this.files[0],a=[u(e),Sr(e)];p(a,G,F,$),m(e,G,F,$),h(e,Je,Qe)}function Sr(e){return Re(e.type)?"":`The chosen file mime type ${e.type} is probably not suitable for an image.`}function et(){Br.innerHTML="",$.innerHTML="",$.classList.add(we),G.innerText="",G.classList.add(we),q.classList.remove(T),te.classList.remove(T),ue.classList.remove(T),F.classList.remove(T)}var Hr="uploader-text-form",w="is-invalid",Ee="d-none",Yr=t(Hr),U=t("uploader-text-alert"),j=t("uploader-text-file"),tt=t("uploader-text-last-modified"),Fr=t("uploader-text-list-1"),jr=t("uploader-text-list-2"),rt=t("uploader-text-magic"),re=t("uploader-text-month"),de=t("uploader-text-releaser-1"),I=t("uploader-text-results"),O=t("uploader-text-year");Yr.addEventListener("reset",function(){tt.value="",rt.value="",st()});j.addEventListener("change",Ar);de.addEventListener("input",c);O.addEventListener("input",f);re.addEventListener("input",d);function at(e){t(e).addEventListener("click",function(){let r=!0;if(de.value==""&&(de.classList.add(w),r=!1),n(O.value)==!1&&(O.classList.add(w),r=!1),o(re.value)==!1&&(re.classList.add(w),r=!1),re.value!=""&&O.value==""&&(O.classList.add(w),r=!1),j.value==""&&(j.classList.add(w),r=!1),r==!1)return L(U,I);st(),I.innerText="...",I.classList.remove(Ee)})}async function Ar(){v(j,U,I);let e=this.files[0],a=[u(e),Cr(e)];p(a,U,j,I),m(e,U,j,I),h(e,tt,rt)}function Cr(e){return Ne(e.type)?"":`The chosen file mime type ${e.type} is probably not suitable for a text.`}function st(){Fr.innerHTML="",jr.innerHTML="",I.innerHTML="",I.classList.add(Ee),U.innerText="",U.classList.add(Ee),O.classList.remove(w),re.classList.remove(w),de.classList.remove(w),j.classList.remove(w)}var Vr="uploader-trainer-form",E="is-invalid",ke="d-none",Rr=t(Vr),Z=t("uploader-trainer-alert"),A=t("uploader-trainer-file"),it=t("uploader-trainer-last-modified"),Nr=t("uploader-trainer-list-1"),Pr=t("uploader-trainer-list-2"),nt=t("uploader-trainer-magic"),ae=t("uploader-trainer-month"),fe=t("uploader-trainer-releaser-1"),B=t("uploader-trainer-results"),X=t("uploader-trainer-year");Rr.addEventListener("reset",function(){it.value="",nt.value="",lt()});A.addEventListener("change",Kr);fe.addEventListener("input",c);X.addEventListener("input",f);ae.addEventListener("input",d);function ot(e){t(e).addEventListener("click",function(){let r=!0;if(fe.value==""&&(fe.classList.add(E),r=!1),n(X.value)==!1&&(X.classList.add(E),r=!1),o(ae.value)==!1&&(ae.classList.add(E),r=!1),ae.value!=""&&X.value==""&&(X.classList.add(E),r=!1),A.value==""&&(A.classList.add(E),r=!1),r==!1)return L(Z,B);lt(),B.innerText="...",B.classList.remove(ke)})}async function Kr(){v(A,Z,B);let e=this.files[0],a=[u(e),qr(e)];p(a,Z,A,B),m(e,Z,A,B),h(e,it,nt)}function qr(e){return oe(e.type)?"":`The chosen file mime type ${e.type} is probably not suitable for an intro.`}function lt(){Nr.innerHTML="",Pr.innerHTML="",B.innerHTML="",B.classList.add(ke),Z.innerText="",Z.classList.add(ke),X.classList.remove(E),ae.classList.remove(E),fe.classList.remove(E),A.classList.remove(E)}var Gr="uploader-advanced-form",i="is-invalid",Me="d-none",Or=t(Gr),J=t("uploader-advanced-alert"),pe=t("uploader-advanced-category"),Ur=t("uploader-advanced-classification-help"),me=t("uploader-advanced-day"),C=t("uploader-advanced-file"),ct=t("uploader-advanced-last-modified"),Xr=t("uploader-advanced-list-1"),Zr=t("uploader-advanced-list-2"),ut=t("uploader-advanced-magic"),se=t("uploader-advanced-month"),he=t("uploader-advanced-operating-system"),ve=t("uploader-advanced-releaser-1"),D=t("uploader-advanced-results"),_=t("uploader-advanced-year");Or.addEventListener("reset",function(){ct.value="",ut.value="",ft()});C.addEventListener("change",_r);ve.addEventListener("input",c);_.addEventListener("input",f);se.addEventListener("input",d);me.addEventListener("input",De);pe.addEventListener("change",c);he.addEventListener("change",c);function dt(e){t(e).addEventListener("click",function(){let r=!0;if(ve.value==""&&(ve.classList.add(i),r=!1),n(_.value)==!1&&(_.classList.add(i),r=!1),o(se.value)==!1&&(se.classList.add(i),r=!1),ie(me.value)==!1&&(me.classList.add(i),r=!1),se.value!=""&&_.value==""&&(_.classList.add(i),r=!1),C.value==""&&(C.classList.add(i),r=!1),he.value==""&&(he.classList.add(i),r=!1),pe.value==""&&(pe.classList.add(i),r=!1),r==!1)return L(J,D);ft(),D.innerText="...",D.classList.remove(Me)})}async function _r(){v(C,J,D);let e=this.files[0],a=[u(e),Jr(e)];p(a,J,C,D),m(e,J,C,D),h(e,ct,ut)}function Jr(e){return Ce(e.type)?`The chosen file mime type ${e.type} is probably not suitable for an upload.`:""}function ft(){Xr.innerHTML="",Zr.innerHTML="",D.innerHTML="",Ur.innerHTML="",D.classList.add(Me),J.innerText="",J.classList.add(Me),_.classList.remove(i),se.classList.remove(i),me.classList.remove(i),ve.classList.remove(i),C.classList.remove(i),he.classList.remove(i),pe.classList.remove(i)}(()=>{"use strict";He(),ye("demozoo-submission","Demozoo"),ye("pouet-submission","Pou\xEBt"),qe("uploader-image-submit"),S("uploader-image-form","uploader-image-progress"),Ze("uploader-intro-submit"),S("uploader-intro-form","uploader-intro-progress"),ot("uploader-trainer-submit"),S("uploader-trainer-form","uploader-trainer-progress"),We("uploader-magazine-submit"),S("uploader-magazine-form","uploader-magazine-progress"),at("uploader-text-submit"),S("uploader-text-form","uploader-text-progress"),dt("uploader-advanced-submit"),S("uploader-advanced-form","uploader-advanced-progress")})();})();
