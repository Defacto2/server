/* uploader.min.js Â© Defacto2 2024 */
(()=>{function s(e){let n=document.getElementById(e);if(n==null)throw new Error(`The ${e} element is null.`);return n}function r(e){if(`${e}`=="")return!0;let n=1980,t=new Date().getFullYear();return!(e<n||e>t)}function l(e){return`${e}`==""?!0:!(e<1||e>12)}function p(e){return`${e}`==""?!0:!(e<1||e>31)}function W(e){let n=document.getElementById(e);if(n==null)throw new Error(`The ${e} element is null.`);n.addEventListener("click",function(){let t="Choose...",o=!0;_(),B.value==""&&(B.classList.add(a),o=!1),(L.value==""||L.value==t)&&(L.classList.add(a),o=!1),(x.value==""||x.value==t)&&(x.classList.add(a),o=!1),b.value==""&&(b.classList.add(a),o=!1),w.value==""&&(w.classList.add(a),o=!1),r(I.value)==!1&&(I.classList.add(a),o=!1),l(M.value)==!1&&(M.classList.add(a),o=!1),p(T.value)==!1&&(T.classList.add(a),o=!1),o==!0&&Z.submit()})}var a="is-invalid",Z=document.getElementById("advancedUploader");Z.addEventListener("reset",_);function _(){B.classList.remove(a),L.classList.remove(a),x.classList.remove(a),b.classList.remove(a),w.classList.remove(a),I.classList.remove(a),M.classList.remove(a),T.classList.remove(a)}var B=document.getElementById("advFile"),L=document.getElementById("advSelOS"),x=document.getElementById("advSelCat"),b=document.getElementById("advTitle"),w=document.getElementById("releasersAdv"),I=document.getElementById("advYear"),M=document.getElementById("advMonth"),T=document.getElementById("advDay");var $=document.getElementById("imageFile"),k=document.getElementById("imageTitle"),S=document.getElementById("imageReleasers"),F=document.getElementById("imageYear"),Y=document.getElementById("imageMonth"),ee=document.getElementById("imageUploader"),d="is-invalid";function te(){$.classList.remove(d),k.classList.remove(d),S.classList.remove(d),F.classList.remove(d),Y.classList.remove(d)}ee.addEventListener("reset",te);function ne(e){let n=document.getElementById(e);if(n==null)throw new Error(`The ${e} element is null.`);n.addEventListener("click",function(){let t=!0;te(),$.value==""&&($.classList.add(d),t=!1),k.value==""&&(k.classList.add(d),t=!1),S.value==""&&(S.classList.add(d),t=!1),r(F.value)==!1&&(F.classList.add(d),t=!1),l(Y.value)==!1&&(Y.classList.add(d),t=!1),t==!0&&ee.submit()})}var oe=document.getElementById("introUploader"),R=document.getElementById("introFile"),C=document.getElementById("releaseTitle"),D=document.getElementById("introReleasers"),U=document.getElementById("introYear"),z=document.getElementById("introMonth"),c="is-invalid";function se(){R.classList.remove(c),C.classList.remove(c),D.classList.remove(c),U.classList.remove(c),z.classList.remove(c)}oe.addEventListener("reset",se);function ae(e){let n=document.getElementById(e);if(n==null)throw new Error(`The ${e} element is null.`);n.addEventListener("click",function(){let t=!0;se(),R.value==""&&(R.classList.add(c),t=!1),C.value==""&&(C.classList.add(c),t=!1),D.value==""&&(D.classList.add(c),t=!1),r(U.value)==!1&&(U.classList.add(c),t=!1),l(z.value)==!1&&(z.classList.add(c),t=!1),t==!0&&oe.submit()})}function h(e){if(bootstrap===void 0)throw new Error("The bootstrap object is undefined.");let n=s(e);return new bootstrap.Modal(n)}function E(e,n){let t=document.getElementById(n);if(t==null)throw new Error(`The ${n} element is null.`);let o=s(e);if(o.addEventListener("shown.bs.modal",function(){t.focus()}),bootstrap===void 0)throw new Error("The bootstrap object is undefined.");return new bootstrap.Modal(o)}var ue=E("uploader-pouet","pouet-submission"),me=E("uploader-demozoo","demozoo-submission"),fe=E("uploader-intro","uploader-intro-file"),ve=h("uploaderText"),ge=h("uploaderImg"),he=h("uploaderMag"),pe=h("uploaderAdv"),Le="d",xe="p",Ee="i",ye="n",Be="g",be="m",we="a";function ie(){document.addEventListener("keydown",function(e){if(!(!e.ctrlKey||!e.altKey))switch(e.key){case Le:me.show();break;case xe:ue.show();break;case Ee:fe.show();break;case ye:ve.show();break;case Be:ge.show();break;case be:he.show();break;case we:pe.show();break}})}var A=document.getElementById("magFile"),j=document.getElementById("magTitle"),q=document.getElementById("magIssue"),H=document.getElementById("magYear"),K=document.getElementById("magMonth"),G=document.getElementById("magDay"),i="is-invalid";function Ie(){A.classList.remove(i),j.classList.remove(i),q.classList.remove(i),H.classList.remove(i),K.classList.remove(i),G.classList.remove(i)}var Me=document.getElementById("magUploader");function re(e){let n=document.getElementById(e);if(n==null)throw new Error(`The ${e} element is null.`);n.addEventListener("click",function(){let t=!0;Ie(),A.value==""&&(A.classList.add(i),t=!1),j.value==""&&(j.classList.add(i),t=!1),q.value==""&&(q.classList.add(i),t=!1),r(H.value)==!1&&(H.classList.add(i),t=!1),l(K.value)==!1&&(K.classList.add(i),t=!1),p(G.value)==!1&&(G.classList.add(i),t=!1),t==!0&&Me.submit()})}function le(e,n){let t=document.getElementById(e);if(t==null)throw new Error(`The ${e} element is null.`);let o=document.getElementById(n);if(o==null)throw new Error(`The ${n} form element is null.`);o.addEventListener("reset",de),t.addEventListener("click",function(){Te()==!0&&o.submit()})}var O=s("textFile"),P=s("textTitle"),X=s("textReleasers"),J=s("textYear"),N=s("textMonth"),u="is-invalid";function de(){O.classList.remove(u),P.classList.remove(u),X.classList.remove(u),J.classList.remove(u),N.classList.remove(u)}function Te(){let e=!0;return de(),O.value==""&&(O.classList.add(u),e=!1),P.value==""&&(P.classList.add(u),e=!1),X.value==""&&(X.classList.add(u),e=!1),r(J.value)==!1&&(J.classList.add(u),e=!1),l(N.value)==!1&&(N.classList.add(u),e=!1),e}var v="d-none";function Q(e,n,t){let o=s(e),m=s(`${e}-error`),y=s(`${e}-results`);s(`${e}-close`).addEventListener("click",V),s(`${e}-clear`).addEventListener("click",V);function V(){o.value="",o.focus(),m.innerText="",m.classList.add(v),y.innerHTML=""}s(n).addEventListener("change",function(){let f=this.files[0],g=document.getElementById("search-results");f.size>10485760&&(g.innerText="File is too big, maximum size is 10MB.",this.value="")}),document.body.addEventListener("htmx:beforeRequest",function(){$e(m,y)}),document.body.addEventListener("htmx:afterRequest",function(f){if(f.detail.elt===null||f.detail.elt.id!==`${e}`)return;if(f.detail.successful)return ke(m);let g=f.detail.xhr;if(f.detail.failed&&g)return g.status===404?Se(m,y,t):Ye(m,g);Fe(m)})}function $e(e,n){n.innerHTML="",e.innerText="",e.classList.add(v)}function ke(e){e.classList.add(v),e.innerText=""}function Se(e,n,t){n.innerText=`Production not found on ${t}.`,e.classList.add(v),e.innerText=""}function Fe(e){e.innerText="Something with the browser is not working, please refresh the page.",e.classList.remove(v)}function Ye(e,n){e.innerText=`Something went wrong, ${n.status} status: ${n.responseText}.`,e.classList.remove(v)}var ce=Re;function Re(){document.body.addEventListener("htmx:afterRequest",function(n){if(console.log("htmx:afterRequest event fired"),n.detail.elt===null||n.detail.elt.id!=="releaserSearch")return;let t=document.getElementById("htmx-alert");if(!(typeof t>"u"||t===null)){if(n.detail.successful){t.setAttribute("hidden","true"),t.innerText="";return}if(n.detail.failed&&n.detail.xhr){let o=n.detail.xhr;t.innerText=`Something on the server is not working, ${o.status} status: ${o.responseText}.`,t.removeAttribute("hidden");return}t.innerText="Something with the browser is not working, please refresh the page.",t.removeAttribute("hidden")}});let e=document.getElementById("htmx-clear");typeof alert<"u"&&alert!==null&&e.addEventListener("click",function(){let n=document.getElementById("releaserSearch");n.value="",n.focus(),document.getElementById("htmx-alert").setAttribute("hidden","true");let o=document.getElementById("indicator");o.style.opacity=0,document.getElementById("search-releaser-results").innerHTML=""}),console.log("htmx: load event loaded"),document.body.addEventListener("htmx:load",function(){console.log("htmx:load event fired"),htmx.on("#uploader-intro-form","htmx:xhr:progress",function(n){console.log("htmx:xhr:progress event fired"),htmx.find("#uploader-intro-progress").setAttribute("value",n.detail.loaded/n.detail.total*100)})})}(()=>{"use strict";ie(),W("advSubmit"),ne("imageSubmit"),ae("introSubmit"),re("magSubmit"),le("textSubmit","textUploader"),Q("demozoo-submission","uploader-intro-file","Demozoo"),Q("pouet-submission","uploader-intro-file","Pou\xEBt"),ce()})();})();
