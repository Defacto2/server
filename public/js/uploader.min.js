/* uploader.min.js Â© Defacto2 2024 */
(()=>{function t(e){let a=document.getElementById(e);if(a==null){console.error(`The ${e} for getElmById() element is null.`);return}return a}function i(e){if(`${e}`=="")return!0;let a=1980,r=new Date().getFullYear();return!(e<a||e>r)}function o(e){return`${e}`==""?!0:!(e<1||e>12)}function ie(e){return`${e}`==""?!0:!(e<1||e>31)}function Se(e,a){if(e=="")return!0;let r=Number(e),s=Number(a);if(!Number.isInteger(s)||s<1)throw new Error(`The ID sanity value is invalid: ${s}`);return Number.isInteger(r)&&r>0&&r<=s}var l="is-invalid",E="d-none",bt=100,ge=1024*1024,He=100*ge;function k(e,a){if(e==null)throw new Error("The elementId value of focusModalById is null.");if(a==null)throw new Error("The submissionId value of focusModalById is null.");let r=document.getElementById(a);if(r==null)throw new Error(`The ${a} element is null.`);let s=t(e);if(s.addEventListener("shown.bs.modal",function(){r.focus()}),bootstrap===void 0)throw new Error("The bootstrap object is undefined.");return new bootstrap.Modal(s,{keyboard:!0})}async function yt(e){if(e==null)throw new Error("The file value of checkSHA is null.");try{let a=await wt(e),r=await fetch(`/uploader/sha384/${a}`,{method:"PATCH",headers:{"Content-Type":"text/plain"},body:a});if(!r.ok)throw new Error(`Hashing is not possible, server response: ${r.status}`);return await r.text()=="true"}catch(a){console.log(`Hashing is not possible: ${a}`)}}async function wt(e){if(e==null)throw new Error("The file value of sha384 is null.");try{let a=await e.arrayBuffer(),r=await crypto.subtle.digest("SHA-384",a);return Array.from(new Uint8Array(r)).map(s=>s.toString(16).padStart(2,"0")).join("")}catch(a){throw new Error(`Could not use arrayBuffer or crypto.subtle: ${a}`)}}function H(e,a){if(e==null)throw new Error("The formId value of progress is null.");if(a==null)throw new Error("The elementId value of progress is null.");htmx.on(`#${e}`,"htmx:xhr:progress",function(r){r.target.id==`${e}`&&htmx.find(`#${a}`).setAttribute("value",r.detail.loaded/r.detail.total*bt)})}function u(e){if(e==null)throw new Error("The file value of checkSize is null.");return e.size>He?`The chosen file is too big at ${Math.round(e.size/ge)}MB, maximum size is ${He/ge}MB.`:""}function Ce(){return ie(this.value)==!1?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function d(){return console.log(`The month value is ${this.value}.`),o(this.value)==!1?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function p(){return i(this.value)==!1?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function f(e,a,r,s){if(e==null)throw new Error("The errors value of checkErrors is null.");if(a==null)throw new Error("The alert value of checkErrors is null.");if(r==null)throw new Error("The fileInput value of checkErrors is null.");if(s==null)throw new Error("The results value of checkErrors is null.");e=e.filter(x=>x!=""),!(e.length<=0)&&(a.innerText=e.join(" "),a.classList.remove(E),r.innerText="",r.classList.add(l),s.classList.add(E))}async function m(e,a,r,s){if(e==null)throw new Error("The file value of checkDuplicate is null.");if(a==null)throw new Error("The alert value of checkDuplicate is null.");if(r==null)throw new Error("The fileInput value of checkDuplicate is null.");if(s==null)throw new Error("The results value of checkDuplicate is null.");await yt(e)!=!1&&(a.innerText=`The chosen file already exists in the database: ${e.name}`,a.classList.remove(E),r.innerText="",r.classList.add(l),s.classList.add(E))}function h(e,a,r){if(e==null)throw new Error("The file1 value of hiddenDetails is null.");if(a==null)throw new Error("The lastMod value of hiddenDetails is null.");if(r==null)throw new Error("The magic value of hiddenDetails is null.");let s=e.lastModified,x=new Date().getTime(),Be=60*60*1e3;x-s<Be||(a.value=s),e.type!=""&&(r.value=e.type)}function c(){return this.value==""?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function Fe(){return this.value==""?(this.classList.remove(l),!0):new RegExp(/^[a-zA-Z0-9_-]{11}$/).test(this.value)==!1?(this.classList.add(l),!1):(this.classList.remove(l),!0)}function v(e,a,r){if(e==null)throw new Error("The fileInput value of resetInput is null.");if(a==null)throw new Error("The alert value of resetInput is null.");if(r==null)throw new Error("The results value of resetInput is null.");e.innerText="",e.classList.remove(l),a.innerText="",a.classList.add(E),r.innerText="",r.classList.add(E)}function L(e,a){if(e==null)throw new Error("The alert value of submitError is null.");if(a==null)throw new Error("The results value of submitError is null.");e.innerText="Please correct the problems with the form.",e.classList.remove(E),a.innerText="",a.classList.add(E)}var xt=k("uploader-pouet-modal","pouet-submission"),kt=k("uploader-demozoo-modal","demozoo-submission"),Tt=k("uploader-intro-modal","uploader-intro-file"),Et=k("uploader-trainer-modal","uploader-trainer-file"),Mt=k("uploader-text-modal","uploader-text-file"),zt=k("uploader-image-modal","uploader-image-file"),It=k("uploader-magazine-modal","uploader-magazine-file"),$t=k("uploader-advanced-modal","uploader-advanced-file"),Bt="d",Dt="p",St="i",Ht="t",Ct="n",Ft="g",At="m",Yt="a";function Ae(){document.addEventListener("keydown",function(e){if(!(!e.ctrlKey||!e.altKey))switch(e.key){case Bt:kt.show();break;case Dt:xt.show();break;case St:Tt.show();break;case Ht:Et.show();break;case Ct:Mt.show();break;case Ft:zt.show();break;case At:It.show();break;case Yt:$t.show();break}})}var be="is-invalid",J="d-none";function ye(e,a){let r=t(e),s=t(`${e}-error`),x=t(`${e}-results`);t(`${e}-close`).addEventListener("click",De),t(`${e}-clear`).addEventListener("click",De);function De(){r.value="",r.focus(),r.classList.remove(be),s.innerText="",s.classList.add(J),x.innerHTML=""}let Lt=45e4,gt=2e5;switch(e){case"demozoo-submission":Ye(r,Lt);break;case"pouet-submission":Ye(r,gt);break}document.body.addEventListener("htmx:beforeRequest",function(){jt(s,x)}),document.body.addEventListener("htmx:beforeSwap",function(S){S.detail.xhr.status>=400&&s.classList.remove(J)}),document.body.addEventListener("htmx:afterRequest",function(S){if(S.detail.elt===null||S.detail.elt.id!==`${e}`)return;if(S.detail.successful)return Vt(r);let ne=S.detail.xhr;if(S.detail.failed&&ne)return ne.status===404?Pt(s,x,a):Rt(s,ne);qt(s)})}function Ye(e,a){e.addEventListener("input",function(){if(!Se(e.value,a)){e.classList.add(be);return}e.classList.remove(be)})}function jt(e,a){a.innerHTML="",e.innerText="",e.classList.add(J)}function Vt(e){e.focus()}function Pt(e,a,r){a.innerText=`Production not found on ${r}.`}function qt(e){e.innerText="Something with the browser is not working, please refresh the page.",e.classList.remove(J)}function Rt(e,a){e.innerText=`Something went wrong, ${a.status} status: ${a.responseText}.`,e.classList.remove(J)}var Nt="application/x-freearc",Ut="application/x-arj",Kt="application/x-bzip",Gt="application/x-bzip2",Xt="application/gzip",Ot="application/vnd.rar",Wt="application/x-tar",Zt="application/zip",_t="application/x-7z-compressed",Jt="application/x-msdos-program",Qt="image/bmp",er="image/gif",tr="image/jpeg",rr="image/vnd.zbrush.pcx",ar="image/png",sr="image/tiff",nr="image/webp",ir="application/x-csh",or="application/x-chrome-extension",lr="text/x-script.perl",cr="application/x-httpd-php",ur="text/x-script.phyton",dr="text/x-script.rexx",pr="application/x-sh",fr="application/x-shellscript",mr="text/x-script.tcl",hr="text/x-shellscript",vr="text/x-script.zsh";function Lr(){return[ir,or,lr,cr,ur,dr,pr,fr,mr,hr,vr]}function je(){return[Jt]}function oe(){return[Nt,Ut,Kt,Gt,Xt,Ot,Wt,Zt,_t]}function Ve(){return["application/octet-stream","application/x-binary","application/x-ms-dos-executable"]}function gr(){return[Qt,er,tr,rr,ar,sr,nr]}function Pe(){return["text/plain","text/x-nfo"]}function qe(e){return Lr().includes(e)}function Re(e){return gr().concat(oe()).includes(e)}function le(e){return je().concat(oe(),Ve()).includes(e)}function Ne(e){return Pe().concat(oe(),je(),Ve()).includes(e)}function Ue(e){return Pe().concat(oe()).includes(e)}var br="uploader-image-form",T="is-invalid",we="d-none",yr=t(br),q=t("uploader-image-alert"),C=t("uploader-image-file"),Ke=t("uploader-image-last-modified"),wr=t("uploader-image-list-1"),xr=t("uploader-image-list-2"),Ge=t("uploader-image-magic"),Q=t("uploader-image-month"),ce=t("uploader-image-releaser-1"),M=t("uploader-image-results"),P=t("uploader-image-year");yr.addEventListener("reset",function(){Ke.value="",Ge.value="",Oe()});C.addEventListener("change",kr);ce.addEventListener("input",c);P.addEventListener("input",p);Q.addEventListener("input",d);function Xe(e){t(e).addEventListener("click",function(){let r=!0;if(ce.value==""&&(ce.classList.add(T),r=!1),i(P.value)==!1&&(P.classList.add(T),r=!1),o(Q.value)==!1&&(Q.classList.add(T),r=!1),Q.value!=""&&P.value==""&&(P.classList.add(T),r=!1),C.value==""&&(C.classList.add(T),r=!1),r==!1)return L(q,M);Oe(),M.innerText="...",M.classList.remove(we)})}async function kr(){v(C,q,M);let e=this.files[0],a=[u(e),Tr(e)];f(a,q,C,M),m(e,q,C,M),h(e,Ke,Ge)}function Tr(e){return Re(e.type)?"":`The chosen file mime type ${e.type} might not be suitable for an image.`}function Oe(){wr.innerHTML="",xr.innerHTML="",M.innerHTML="",M.classList.add(we),q.innerText="",q.classList.add(we),P.classList.remove(T),Q.classList.remove(T),ce.classList.remove(T),C.classList.remove(T)}var Er="uploader-intro-form",w="is-invalid",xe="d-none",Mr=t(Er),N=t("uploader-intro-alert"),F=t("uploader-intro-file"),We=t("uploader-intro-last-modified"),zr=t("uploader-intro-list-1"),Ir=t("uploader-intro-list-2"),Ze=t("uploader-intro-magic"),ee=t("uploader-intro-month"),ue=t("uploader-intro-releaser-1"),z=t("uploader-intro-results"),R=t("uploader-intro-year"),_e=t("uploader-intro-youtube");Mr.addEventListener("reset",function(){We.value="",Ze.value="",Qe()});F.addEventListener("change",$r);ue.addEventListener("input",c);R.addEventListener("input",p);ee.addEventListener("input",d);_e.addEventListener("input",Fe);function Je(e){t(e).addEventListener("click",function(){let r=!0;if(ue.value==""&&(ue.classList.add(w),r=!1),i(R.value)==!1&&(R.classList.add(w),r=!1),o(ee.value)==!1&&(ee.classList.add(w),r=!1),ee.value!=""&&R.value==""&&(R.classList.add(w),r=!1),F.value==""&&(F.classList.add(w),r=!1),r==!1)return L(N,z);Qe(),z.innerText="...",z.classList.remove(xe)})}async function $r(){v(F,N,z);let e=this.files[0],a=[u(e),Br(e)];f(a,N,F,z),m(e,N,F,z),h(e,We,Ze)}function Br(e){return le(e.type)?"":`The chosen file mime type ${e.type} might not be suitable for an intro.`}function Qe(){zr.innerHTML="",Ir.innerHTML="",z.innerHTML="",z.classList.add(xe),N.innerText="",N.classList.add(xe),R.classList.remove(w),ee.classList.remove(w),ue.classList.remove(w),_e.classList.remove(w),F.classList.remove(w)}var Dr="uploader-magazine-form",g="is-invalid",ke="d-none",Sr=t(Dr),K=t("uploader-magazine-alert"),A=t("uploader-magazine-file"),et=t("uploader-magazine-last-modified"),Hr=t("uploader-magazine-list-1"),tt=t("uploader-magazine-magic"),te=t("uploader-magazine-month"),de=t("uploader-magazine-releaser-1"),I=t("uploader-magazine-results"),Te=t("uploader-magazine-title"),U=t("uploader-magazine-year");Sr.addEventListener("reset",function(){et.value="",tt.value="",at()});A.addEventListener("change",Cr);de.addEventListener("input",c);U.addEventListener("input",p);te.addEventListener("input",d);function rt(e){t(e).addEventListener("click",function(){let r=!0;if(Te.value==""&&(Te.classList.add(g),r=!1),de.value==""&&(de.classList.add(g),r=!1),i(U.value)==!1&&(U.classList.add(g),r=!1),o(te.value)==!1&&(te.classList.add(g),r=!1),te.value!=""&&U.value==""&&(U.classList.add(g),r=!1),A.value==""&&(A.classList.add(g),r=!1),r==!1)return L(K,I);at(),I.innerText="...",I.classList.remove(ke)})}async function Cr(){v(A,K,I);let e=this.files[0],a=[u(e),Fr(e)];f(a,K,A,I),m(e,K,A,I),h(e,et,tt)}function Fr(e){return Ne(e.type)?"":`The chosen file mime type ${e.type} might not be suitable for an image.`}function at(){Hr.innerHTML="",I.innerHTML="",I.classList.add(ke),K.innerText="",K.classList.add(ke),U.classList.remove(g),te.classList.remove(g),de.classList.remove(g),A.classList.remove(g),Te.classList.remove(g)}var Ar="uploader-text-form",b="is-invalid",Ee="d-none",Yr=t(Ar),X=t("uploader-text-alert"),Y=t("uploader-text-file"),st=t("uploader-text-last-modified"),jr=t("uploader-text-list-1"),Vr=t("uploader-text-list-2"),nt=t("uploader-text-magic"),re=t("uploader-text-month"),pe=t("uploader-text-releaser-1"),$=t("uploader-text-results"),Me=t("uploader-text-title"),G=t("uploader-text-year");Yr.addEventListener("reset",function(){st.value="",nt.value="",ot()});Y.addEventListener("change",Pr);pe.addEventListener("input",c);G.addEventListener("input",p);re.addEventListener("input",d);function it(e){t(e).addEventListener("click",function(){let r=!0;if(Me.value==""&&(Me.classList.add(b),r=!1),pe.value==""&&(pe.classList.add(b),r=!1),i(G.value)==!1&&(G.classList.add(b),r=!1),o(re.value)==!1&&(re.classList.add(b),r=!1),re.value!=""&&G.value==""&&(G.classList.add(b),r=!1),Y.value==""&&(Y.classList.add(b),r=!1),r==!1)return L(X,$);ot(),$.innerText="...",$.classList.remove(Ee)})}async function Pr(){v(Y,X,$);let e=this.files[0],a=[u(e),qr(e)];f(a,X,Y,$),m(e,X,Y,$),h(e,st,nt)}function qr(e){return Ue(e.type)?"":`The chosen file mime type ${e.type} might not be suitable for a text.`}function ot(){jr.innerHTML="",Vr.innerHTML="",$.innerHTML="",$.classList.add(Ee),X.innerText="",X.classList.add(Ee),G.classList.remove(b),re.classList.remove(b),pe.classList.remove(b),Y.classList.remove(b),Me.classList.remove(b)}var Rr="uploader-trainer-form",y="is-invalid",ze="d-none",Nr=t(Rr),W=t("uploader-trainer-alert"),j=t("uploader-trainer-file"),lt=t("uploader-trainer-last-modified"),Ur=t("uploader-trainer-list-1"),Kr=t("uploader-trainer-list-2"),ct=t("uploader-trainer-magic"),ae=t("uploader-trainer-month"),fe=t("uploader-trainer-releaser-1"),B=t("uploader-trainer-results"),Ie=t("uploader-trainer-title"),O=t("uploader-trainer-year");Nr.addEventListener("reset",function(){lt.value="",ct.value="",dt()});j.addEventListener("change",Gr);fe.addEventListener("input",c);O.addEventListener("input",p);ae.addEventListener("input",d);function ut(e){t(e).addEventListener("click",function(){let r=!0;if(Ie.value==""&&(Ie.classList.add(y),r=!1),fe.value==""&&(fe.classList.add(y),r=!1),i(O.value)==!1&&(O.classList.add(y),r=!1),o(ae.value)==!1&&(ae.classList.add(y),r=!1),ae.value!=""&&O.value==""&&(O.classList.add(y),r=!1),j.value==""&&(j.classList.add(y),r=!1),r==!1)return L(W,B);dt(),B.innerText="...",B.classList.remove(ze)})}async function Gr(){v(j,W,B);let e=this.files[0],a=[u(e),Xr(e)];f(a,W,j,B),m(e,W,j,B),h(e,lt,ct)}function Xr(e){return le(e.type)?"":`The chosen file mime type ${e.type} might not be suitable for an intro.`}function dt(){Ur.innerHTML="",Kr.innerHTML="",B.innerHTML="",B.classList.add(ze),W.innerText="",W.classList.add(ze),O.classList.remove(y),ae.classList.remove(y),fe.classList.remove(y),j.classList.remove(y),Ie.classList.remove(y)}var Or="uploader-advanced-form",n="is-invalid",$e="d-none",Wr=t(Or),_=t("uploader-advanced-alert"),me=t("uploader-advanced-category"),Zr=t("uploader-advanced-classification-help"),he=t("uploader-advanced-day"),V=t("uploader-advanced-file"),pt=t("uploader-advanced-last-modified"),_r=t("uploader-advanced-list-1"),Jr=t("uploader-advanced-list-2"),ft=t("uploader-advanced-magic"),se=t("uploader-advanced-month"),ve=t("uploader-advanced-operating-system"),Le=t("uploader-advanced-releaser-1"),D=t("uploader-advanced-results"),Z=t("uploader-advanced-year");Wr.addEventListener("reset",function(){pt.value="",ft.value="",ht()});V.addEventListener("change",Qr);Le.addEventListener("input",c);Z.addEventListener("input",p);se.addEventListener("input",d);he.addEventListener("input",Ce);me.addEventListener("change",c);ve.addEventListener("change",c);function mt(e){t(e).addEventListener("click",function(){let r=!0;if(Le.value==""&&(Le.classList.add(n),r=!1),i(Z.value)==!1&&(Z.classList.add(n),r=!1),o(se.value)==!1&&(se.classList.add(n),r=!1),ie(he.value)==!1&&(he.classList.add(n),r=!1),se.value!=""&&Z.value==""&&(Z.classList.add(n),r=!1),V.value==""&&(V.classList.add(n),r=!1),ve.value==""&&(ve.classList.add(n),r=!1),me.value==""&&(me.classList.add(n),r=!1),r==!1)return L(_,D);ht(),D.innerText="...",D.classList.remove($e)})}async function Qr(){v(V,_,D);let e=this.files[0],a=[u(e),ea(e)];f(a,_,V,D),m(e,_,V,D),h(e,pt,ft)}function ea(e){return qe(e.type)?`The chosen file mime type ${e.type} might not be suitable for an upload.`:""}function ht(){_r.innerHTML="",Jr.innerHTML="",D.innerHTML="",Zr.innerHTML="",D.classList.add($e),_.innerText="",_.classList.add($e),Z.classList.remove(n),se.classList.remove(n),he.classList.remove(n),Le.classList.remove(n),V.classList.remove(n),ve.classList.remove(n),me.classList.remove(n)}(()=>{"use strict";Ae(),ye("demozoo-submission","Demozoo"),ye("pouet-submission","Pou\xEBt"),Xe("uploader-image-submit"),H("uploader-image-form","uploader-image-progress"),Je("uploader-intro-submit"),H("uploader-intro-form","uploader-intro-progress"),ut("uploader-trainer-submit"),H("uploader-trainer-form","uploader-trainer-progress"),rt("uploader-magazine-submit"),H("uploader-magazine-form","uploader-magazine-progress"),it("uploader-text-submit"),H("uploader-text-form","uploader-text-progress"),mt("uploader-advanced-submit"),H("uploader-advanced-form","uploader-advanced-progress")})();})();
