/* uploader.min.js Â© Defacto2 2024 */
(()=>{function n(e){let s=document.getElementById(e);if(s==null)throw new Error(`The ${e} element is null.`);return s}function l(e){if(`${e}`=="")return!0;let s=1980,t=new Date().getFullYear();return!(e<s||e>t)}function r(e){return`${e}`==""?!0:!(e<1||e>12)}function L(e){return`${e}`==""?!0:!(e<1||e>31)}function W(e){let s=document.getElementById(e);if(s==null)throw new Error(`The ${e} element is null.`);s.addEventListener("click",function(){let t="Choose...",o=!0;_(),B.value==""&&(B.classList.add(a),o=!1),(h.value==""||h.value==t)&&(h.classList.add(a),o=!1),(E.value==""||E.value==t)&&(E.classList.add(a),o=!1),b.value==""&&(b.classList.add(a),o=!1),w.value==""&&(w.classList.add(a),o=!1),l(M.value)==!1&&(M.classList.add(a),o=!1),r(I.value)==!1&&(I.classList.add(a),o=!1),L(T.value)==!1&&(T.classList.add(a),o=!1),o==!0&&Z.submit()})}var a="is-invalid",Z=document.getElementById("advancedUploader");Z.addEventListener("reset",_);function _(){B.classList.remove(a),h.classList.remove(a),E.classList.remove(a),b.classList.remove(a),w.classList.remove(a),M.classList.remove(a),I.classList.remove(a),T.classList.remove(a)}var B=document.getElementById("advFile"),h=document.getElementById("advSelOS"),E=document.getElementById("advSelCat"),b=document.getElementById("advTitle"),w=document.getElementById("releasersAdv"),M=document.getElementById("advYear"),I=document.getElementById("advMonth"),T=document.getElementById("advDay");var $=document.getElementById("imageFile"),k=document.getElementById("imageTitle"),F=document.getElementById("imageReleasers"),S=document.getElementById("imageYear"),Y=document.getElementById("imageMonth"),ee=document.getElementById("imageUploader"),d="is-invalid";function te(){$.classList.remove(d),k.classList.remove(d),F.classList.remove(d),S.classList.remove(d),Y.classList.remove(d)}ee.addEventListener("reset",te);function se(e){let s=document.getElementById(e);if(s==null)throw new Error(`The ${e} element is null.`);s.addEventListener("click",function(){let t=!0;te(),$.value==""&&($.classList.add(d),t=!1),k.value==""&&(k.classList.add(d),t=!1),F.value==""&&(F.classList.add(d),t=!1),l(S.value)==!1&&(S.classList.add(d),t=!1),r(Y.value)==!1&&(Y.classList.add(d),t=!1),t==!0&&ee.submit()})}var oe=document.getElementById("introUploader"),R=document.getElementById("introFile"),C=document.getElementById("releaseTitle"),D=document.getElementById("introReleasers"),U=document.getElementById("introYear"),z=document.getElementById("introMonth"),c="is-invalid";function ne(){R.classList.remove(c),C.classList.remove(c),D.classList.remove(c),U.classList.remove(c),z.classList.remove(c)}oe.addEventListener("reset",ne);function ae(e){let s=document.getElementById(e);if(s==null)throw new Error(`The ${e} element is null.`);s.addEventListener("click",function(){let t=!0;ne(),R.value==""&&(R.classList.add(c),t=!1),C.value==""&&(C.classList.add(c),t=!1),D.value==""&&(D.classList.add(c),t=!1),l(U.value)==!1&&(U.classList.add(c),t=!1),r(z.value)==!1&&(z.classList.add(c),t=!1),t==!0&&oe.submit()})}function p(e){if(bootstrap===void 0)throw new Error("The bootstrap object is undefined.");let s=n(e);return new bootstrap.Modal(s)}function y(e,s){let t=document.getElementById(s);if(t==null)throw new Error(`The ${s} element is null.`);let o=n(e);if(o.addEventListener("shown.bs.modal",function(){t.focus()}),bootstrap===void 0)throw new Error("The bootstrap object is undefined.");return new bootstrap.Modal(o)}var ce=y("uploader-pouet-modal","pouet-submission"),ue=y("uploader-demozoo-modal","demozoo-submission"),me=y("uploader-intro-modal","uploader-intro-file"),fe=p("uploaderText"),ve=p("uploaderImg"),ge=p("uploaderMag"),pe=p("uploaderAdv"),Le="d",he="p",Ee="i",ye="n",xe="g",Be="m",be="a";function ie(){document.addEventListener("keydown",function(e){if(!(!e.ctrlKey||!e.altKey))switch(e.key){case Le:ue.show();break;case he:ce.show();break;case Ee:me.show();break;case ye:fe.show();break;case xe:ve.show();break;case Be:ge.show();break;case be:pe.show();break}})}var j=document.getElementById("magFile"),K=document.getElementById("magTitle"),q=document.getElementById("magIssue"),A=document.getElementById("magYear"),G=document.getElementById("magMonth"),H=document.getElementById("magDay"),i="is-invalid";function we(){j.classList.remove(i),K.classList.remove(i),q.classList.remove(i),A.classList.remove(i),G.classList.remove(i),H.classList.remove(i)}var Me=document.getElementById("magUploader");function le(e){let s=document.getElementById(e);if(s==null)throw new Error(`The ${e} element is null.`);s.addEventListener("click",function(){let t=!0;we(),j.value==""&&(j.classList.add(i),t=!1),K.value==""&&(K.classList.add(i),t=!1),q.value==""&&(q.classList.add(i),t=!1),l(A.value)==!1&&(A.classList.add(i),t=!1),r(G.value)==!1&&(G.classList.add(i),t=!1),L(H.value)==!1&&(H.classList.add(i),t=!1),t==!0&&Me.submit()})}function re(e,s){let t=document.getElementById(e);if(t==null)throw new Error(`The ${e} element is null.`);let o=document.getElementById(s);if(o==null)throw new Error(`The ${s} form element is null.`);o.addEventListener("reset",de),t.addEventListener("click",function(){Ie()==!0&&o.submit()})}var O=n("textFile"),P=n("textTitle"),X=n("textReleasers"),J=n("textYear"),N=n("textMonth"),u="is-invalid";function de(){O.classList.remove(u),P.classList.remove(u),X.classList.remove(u),J.classList.remove(u),N.classList.remove(u)}function Ie(){let e=!0;return de(),O.value==""&&(O.classList.add(u),e=!1),P.value==""&&(P.classList.add(u),e=!1),X.value==""&&(X.classList.add(u),e=!1),l(J.value)==!1&&(J.classList.add(u),e=!1),r(N.value)==!1&&(N.classList.add(u),e=!1),e}var v="d-none";function Q(e,s,t){let o=n(e),m=n(`${e}-error`),x=n(`${e}-results`);n(`${e}-close`).addEventListener("click",V),n(`${e}-clear`).addEventListener("click",V);function V(){o.value="",o.focus(),m.innerText="",m.classList.add(v),x.innerHTML=""}n(s).addEventListener("change",function(){let f=this.files[0],g=document.getElementById("search-results");f.size>10485760&&(g.innerText="File is too big, maximum size is 10MB.",this.value="")}),document.body.addEventListener("htmx:beforeRequest",function(){Te(m,x)}),document.body.addEventListener("htmx:afterRequest",function(f){if(f.detail.elt===null||f.detail.elt.id!==`${e}`)return;if(f.detail.successful)return $e(m);let g=f.detail.xhr;if(f.detail.failed&&g)return g.status===404?ke(m,x,t):Se(m,g);Fe(m)})}function Te(e,s){s.innerHTML="",e.innerText="",e.classList.add(v)}function $e(e){e.classList.add(v),e.innerText=""}function ke(e,s,t){s.innerText=`Production not found on ${t}.`,e.classList.add(v),e.innerText=""}function Fe(e){e.innerText="Something with the browser is not working, please refresh the page.",e.classList.remove(v)}function Se(e,s){e.innerText=`Something went wrong, ${s.status} status: ${s.responseText}.`,e.classList.remove(v)}(()=>{"use strict";ie(),W("advSubmit"),se("imageSubmit"),ae("introSubmit"),le("magSubmit"),re("textSubmit","textUploader"),Q("demozoo-submission","uploader-intro-file","Demozoo"),Q("pouet-submission","uploader-intro-file","Pou\xEBt")})();})();
