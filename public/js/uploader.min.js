/* uploader.min.js Â© Defacto2 2024 */
(()=>{function r(e){let a=document.getElementById(e);if(a==null)throw new Error(`The ${e} element is null.`);return a}function o(e){if(`${e}`=="")return!0;let a=1980,t=new Date().getFullYear();return!(e<a||e>t)}function l(e){return`${e}`==""?!0:!(e<1||e>12)}function W(e){return`${e}`==""?!0:!(e<1||e>31)}function ye(e,a){if(e=="")return!0;let t=Number(e),s=Number(a);if(!Number.isInteger(s)||s<1)throw new Error(`The ID sanity value is invalid: ${s}`);return Number.isInteger(t)&&t>0&&t<=s}var i="is-invalid",b="d-none",st=100,ue=1024*1024,we=100*ue;function E(e,a){if(e==null)throw new Error("The elementId value of focusModalById is null.");if(a==null)throw new Error("The submissionId value of focusModalById is null.");let t=document.getElementById(a);if(t==null)throw new Error(`The ${a} element is null.`);let s=r(e);if(s.addEventListener("shown.bs.modal",function(){t.focus()}),bootstrap===void 0)throw new Error("The bootstrap object is undefined.");return new bootstrap.Modal(s,{keyboard:!0})}async function nt(e){if(e==null)throw new Error("The file value of checkSHA is null.");try{let a=await it(e),t=await fetch(`/uploader/sha384/${a}`,{method:"PUT",headers:{"Content-Type":"text/plain"},body:a});if(!t.ok)throw new Error(`Hashing is not possible, server response: ${t.status}`);return await t.text()=="true"}catch(a){console.log(`Hashing is not possible: ${a}`)}}async function it(e){if(e==null)throw new Error("The file value of sha384 is null.");try{let a=await e.arrayBuffer(),t=await crypto.subtle.digest("SHA-384",a);return Array.from(new Uint8Array(t)).map(s=>s.toString(16).padStart(2,"0")).join("")}catch(a){throw new Error(`Could not use arrayBuffer or crypto.subtle: ${a}`)}}function F(e,a){if(e==null)throw new Error("The formId value of progress is null.");if(a==null)throw new Error("The elementId value of progress is null.");htmx.on(`#${e}`,"htmx:xhr:progress",function(t){t.target.id==`${e}`&&htmx.find(`#${a}`).setAttribute("value",t.detail.loaded/t.detail.total*st)})}function u(e){if(e==null)throw new Error("The file value of checkSize is null.");return e.size>we?`The chosen file is too big at ${Math.round(e.size/ue)}MB, maximum size is ${we/ue}MB.`:""}function Te(){return W(this.value)==!1?(this.classList.add(i),!1):(this.classList.remove(i),!0)}function d(){return console.log(`The month value is ${this.value}.`),l(this.value)==!1?(this.classList.add(i),!1):(this.classList.remove(i),!0)}function f(){return o(this.value)==!1?(this.classList.add(i),!1):(this.classList.remove(i),!0)}function p(e,a,t,s){if(e==null)throw new Error("The errors value of checkErrors is null.");if(a==null)throw new Error("The alert value of checkErrors is null.");if(t==null)throw new Error("The fileInput value of checkErrors is null.");if(s==null)throw new Error("The results value of checkErrors is null.");e=e.filter(g=>g!=""),!(e.length<=0)&&(a.innerText=e.join(" "),a.classList.remove(b),t.innerText="",t.classList.add(i),s.classList.add(b))}async function m(e,a,t,s){if(e==null)throw new Error("The file value of checkDuplicate is null.");if(a==null)throw new Error("The alert value of checkDuplicate is null.");if(t==null)throw new Error("The fileInput value of checkDuplicate is null.");if(s==null)throw new Error("The results value of checkDuplicate is null.");await nt(e)!=!1&&(a.innerText=`The chosen file already exists in the database: ${e.name}`,a.classList.remove(b),t.innerText="",t.classList.add(i),s.classList.add(b))}function h(e,a,t){if(e==null)throw new Error("The file1 value of hiddenDetails is null.");if(a==null)throw new Error("The lastMod value of hiddenDetails is null.");if(t==null)throw new Error("The magic value of hiddenDetails is null.");let s=e.lastModified,g=new Date().getTime(),Le=60*60*1e3;g-s<Le||(a.value=s),e.type!=""&&(t.value=e.type)}function c(){return this.value==""?(this.classList.add(i),!1):(this.classList.remove(i),!0)}function be(){return this.value==""?(this.classList.remove(i),!0):new RegExp(/^[a-zA-Z0-9_-]{11}$/).test(this.value)==!1?(this.classList.add(i),!1):(this.classList.remove(i),!0)}function v(e,a,t){if(e==null)throw new Error("The fileInput value of resetInput is null.");if(a==null)throw new Error("The alert value of resetInput is null.");if(t==null)throw new Error("The results value of resetInput is null.");e.innerText="",e.classList.remove(i),a.innerText="",a.classList.add(b),t.innerText="",t.classList.add(b)}function x(e,a){if(e==null)throw new Error("The alert value of submitError is null.");if(a==null)throw new Error("The results value of submitError is null.");e.innerText="Please correct the problems with the form.",e.classList.remove(b),a.innerText="",a.classList.add(b)}var ot=E("uploader-pouet-modal","pouet-submission"),lt=E("uploader-demozoo-modal","demozoo-submission"),ct=E("uploader-intro-modal","uploader-intro-file"),ut=E("uploader-text-modal","uploader-text-file"),dt=E("uploader-image-modal","uploader-image-file"),ft=E("uploader-magazine-modal","uploader-magazine-file"),pt=E("uploader-advanced-modal","uploader-advanced-file"),mt="d",ht="p",vt="i",xt="n",Lt="g",gt="m",yt="a";function Ee(){document.addEventListener("keydown",function(e){if(!(!e.ctrlKey||!e.altKey))switch(e.key){case mt:lt.show();break;case ht:ot.show();break;case vt:ct.show();break;case xt:ut.show();break;case Lt:dt.show();break;case gt:ft.show();break;case yt:pt.show();break}})}var de="is-invalid",j="d-none";function fe(e,a){let t=r(e),s=r(`${e}-error`),g=r(`${e}-results`);r(`${e}-close`).addEventListener("click",ge),r(`${e}-clear`).addEventListener("click",ge);function ge(){t.value="",t.focus(),t.classList.remove(de),s.innerText="",s.classList.add(j),g.innerHTML=""}let rt=45e4,at=2e5;switch(e){case"demozoo-submission":ke(t,rt);break;case"pouet-submission":ke(t,at);break}document.body.addEventListener("htmx:beforeRequest",function(){wt(s,g)}),document.body.addEventListener("htmx:afterRequest",function(U){if(U.detail.elt===null||U.detail.elt.id!==`${e}`)return;if(U.detail.successful)return Tt(s);let ce=U.detail.xhr;if(U.detail.failed&&ce)return ce.status===404?bt(s,g,a):kt(s,ce);Et(s)})}function ke(e,a){e.addEventListener("input",function(){if(!ye(e.value,a)){e.classList.add(de);return}e.classList.remove(de)})}function wt(e,a){a.innerHTML="",e.innerText="",e.classList.add(j)}function Tt(e){e.classList.add(j),e.innerText=""}function bt(e,a,t){a.innerText=`Production not found on ${t}.`,e.classList.add(j),e.innerText=""}function Et(e){e.innerText="Something with the browser is not working, please refresh the page.",e.classList.remove(j)}function kt(e,a){e.innerText=`Something went wrong, ${a.status} status: ${a.responseText}.`,e.classList.remove(j)}var Mt="application/x-freearc",zt="application/x-arj",$t="application/x-bzip",Bt="application/x-bzip2",It="application/gzip",Dt="application/vnd.rar",St="application/x-tar",Ht="application/zip",Yt="application/x-7z-compressed",Ft="application/x-msdos-program",jt="image/bmp",At="image/gif",Ct="image/jpeg",Vt="image/vnd.zbrush.pcx",Rt="image/png",Nt="image/tiff",Pt="image/webp",Kt="application/x-csh",qt="application/x-chrome-extension",Gt="text/x-script.perl",Ot="application/x-httpd-php",Ut="text/x-script.phyton",Xt="text/x-script.rexx",Zt="application/x-sh",_t="application/x-shellscript",Jt="text/x-script.tcl",Qt="text/x-shellscript",Wt="text/x-script.zsh";function er(){return[Kt,qt,Gt,Ot,Ut,Xt,Zt,_t,Jt,Qt,Wt]}function Me(){return[Ft]}function ee(){return[Mt,zt,$t,Bt,It,Dt,St,Ht,Yt]}function ze(){return["application/octet-stream","application/x-binary","application/x-ms-dos-executable"]}function tr(){return[jt,At,Ct,Vt,Rt,Nt,Pt]}function $e(){return["text/plain","text/x-nfo"]}function Be(e){return er().includes(e)}function Ie(e){return tr().concat(ee()).includes(e)}function De(e){return Me().concat(ee(),ze()).includes(e)}function Se(e){return $e().concat(ee(),Me(),ze()).includes(e)}function He(e){return $e().concat(ee()).includes(e)}var rr="uploader-image-form",y="is-invalid",pe="d-none",ar=r(rr),C=r("uploader-image-alert"),I=r("uploader-image-file"),Ye=r("uploader-image-last-modified"),sr=r("uploader-image-list-1"),nr=r("uploader-image-list-2"),Fe=r("uploader-image-magic"),X=r("uploader-image-month"),te=r("uploader-image-releaser-1"),k=r("uploader-image-results"),A=r("uploader-image-year");ar.addEventListener("reset",function(){Ye.value="",Fe.value="",Ae()});I.addEventListener("change",ir);te.addEventListener("input",c);A.addEventListener("input",f);X.addEventListener("input",d);function je(e){r(e).addEventListener("click",function(){let t=!0;if(te.value==""&&(te.classList.add(y),t=!1),o(A.value)==!1&&(A.classList.add(y),t=!1),l(X.value)==!1&&(X.classList.add(y),t=!1),X.value!=""&&A.value==""&&(A.classList.add(y),t=!1),I.value==""&&(I.classList.add(y),t=!1),t==!1)return x(C,k);Ae(),k.innerText="...",k.classList.remove(pe)})}async function ir(){v(I,C,k);let e=this.files[0],a=[u(e),or(e)];p(a,C,I,k),m(e,C,I,k),h(e,Ye,Fe)}function or(e){return Ie(e.type)?"":`The chosen file mime type ${e.type} is probably not suitable for an image.`}function Ae(){sr.innerHTML="",nr.innerHTML="",k.innerHTML="",k.classList.add(pe),C.innerText="",C.classList.add(pe),A.classList.remove(y),X.classList.remove(y),te.classList.remove(y),I.classList.remove(y)}var lr="uploader-intro-form",L="is-invalid",me="d-none",cr=r(lr),R=r("uploader-intro-alert"),D=r("uploader-intro-file"),Ce=r("uploader-intro-last-modified"),ur=r("uploader-intro-list-1"),dr=r("uploader-intro-list-2"),Ve=r("uploader-intro-magic"),Z=r("uploader-intro-month"),re=r("uploader-intro-releaser-1"),M=r("uploader-intro-results"),V=r("uploader-intro-year"),Re=r("uploader-intro-youtube");cr.addEventListener("reset",function(){Ce.value="",Ve.value="",Pe()});D.addEventListener("change",fr);re.addEventListener("input",c);V.addEventListener("input",f);Z.addEventListener("input",d);Re.addEventListener("input",be);function Ne(e){r(e).addEventListener("click",function(){let t=!0;if(re.value==""&&(re.classList.add(L),t=!1),o(V.value)==!1&&(V.classList.add(L),t=!1),l(Z.value)==!1&&(Z.classList.add(L),t=!1),Z.value!=""&&V.value==""&&(V.classList.add(L),t=!1),D.value==""&&(D.classList.add(L),t=!1),t==!1)return x(R,M);Pe(),M.innerText="...",M.classList.remove(me)})}async function fr(){v(D,R,M);let e=this.files[0],a=[u(e),pr(e)];p(a,R,D,M),m(e,R,D,M),h(e,Ce,Ve)}function pr(e){return De(e.type)?"":`The chosen file mime type ${e.type} is probably not suitable for an intro.`}function Pe(){ur.innerHTML="",dr.innerHTML="",M.innerHTML="",M.classList.add(me),R.innerText="",R.classList.add(me),V.classList.remove(L),Z.classList.remove(L),re.classList.remove(L),Re.classList.remove(L),D.classList.remove(L)}var mr="uploader-magazine-form",w="is-invalid",he="d-none",hr=r(mr),P=r("uploader-magazine-alert"),S=r("uploader-magazine-file"),Ke=r("uploader-magazine-last-modified"),vr=r("uploader-magazine-list-1"),qe=r("uploader-magazine-magic"),_=r("uploader-magazine-month"),ae=r("uploader-magazine-releaser-1"),z=r("uploader-magazine-results"),N=r("uploader-magazine-year");hr.addEventListener("reset",function(){Ke.value="",qe.value="",Oe()});S.addEventListener("change",xr);ae.addEventListener("input",c);N.addEventListener("input",f);_.addEventListener("input",d);function Ge(e){r(e).addEventListener("click",function(){let t=!0;if(ae.value==""&&(ae.classList.add(w),t=!1),o(N.value)==!1&&(N.classList.add(w),t=!1),l(_.value)==!1&&(_.classList.add(w),t=!1),_.value!=""&&N.value==""&&(N.classList.add(w),t=!1),S.value==""&&(S.classList.add(w),t=!1),t==!1)return x(P,z);Oe(),z.innerText="...",z.classList.remove(he)})}async function xr(){v(S,P,z);let e=this.files[0],a=[u(e),Lr(e)];p(a,P,S,z),m(e,P,S,z),h(e,Ke,qe)}function Lr(e){return Se(e.type)?"":`The chosen file mime type ${e.type} is probably not suitable for an image.`}function Oe(){vr.innerHTML="",z.innerHTML="",z.classList.add(he),P.innerText="",P.classList.add(he),N.classList.remove(w),_.classList.remove(w),ae.classList.remove(w),S.classList.remove(w)}var gr="uploader-text-form",T="is-invalid",ve="d-none",yr=r(gr),q=r("uploader-text-alert"),H=r("uploader-text-file"),Ue=r("uploader-text-last-modified"),wr=r("uploader-text-list-1"),Tr=r("uploader-text-list-2"),Xe=r("uploader-text-magic"),J=r("uploader-text-month"),se=r("uploader-text-releaser-1"),$=r("uploader-text-results"),K=r("uploader-text-year");yr.addEventListener("reset",function(){Ue.value="",Xe.value="",_e()});H.addEventListener("change",br);se.addEventListener("input",c);K.addEventListener("input",f);J.addEventListener("input",d);function Ze(e){r(e).addEventListener("click",function(){let t=!0;if(se.value==""&&(se.classList.add(T),t=!1),o(K.value)==!1&&(K.classList.add(T),t=!1),l(J.value)==!1&&(J.classList.add(T),t=!1),J.value!=""&&K.value==""&&(K.classList.add(T),t=!1),H.value==""&&(H.classList.add(T),t=!1),t==!1)return x(q,$);_e(),$.innerText="...",$.classList.remove(ve)})}async function br(){v(H,q,$);let e=this.files[0],a=[u(e),Er(e)];p(a,q,H,$),m(e,q,H,$),h(e,Ue,Xe)}function Er(e){return He(e.type)?"":`The chosen file mime type ${e.type} is probably not suitable for a text.`}function _e(){wr.innerHTML="",Tr.innerHTML="",$.innerHTML="",$.classList.add(ve),q.innerText="",q.classList.add(ve),K.classList.remove(T),J.classList.remove(T),se.classList.remove(T),H.classList.remove(T)}var kr="uploader-advanced-form",n="is-invalid",xe="d-none",Mr=r(kr),O=r("uploader-advanced-alert"),ne=r("uploader-advanced-category"),zr=r("uploader-advanced-classification-help"),ie=r("uploader-advanced-day"),Y=r("uploader-advanced-file"),Je=r("uploader-advanced-last-modified"),$r=r("uploader-advanced-list-1"),Br=r("uploader-advanced-list-2"),Qe=r("uploader-advanced-magic"),Q=r("uploader-advanced-month"),oe=r("uploader-advanced-operating-system"),le=r("uploader-advanced-releaser-1"),B=r("uploader-advanced-results"),G=r("uploader-advanced-year");Mr.addEventListener("reset",function(){Je.value="",Qe.value="",et()});Y.addEventListener("change",Ir);le.addEventListener("input",c);G.addEventListener("input",f);Q.addEventListener("input",d);ie.addEventListener("input",Te);ne.addEventListener("change",c);oe.addEventListener("change",c);function We(e){r(e).addEventListener("click",function(){let t=!0;if(le.value==""&&(le.classList.add(n),t=!1),o(G.value)==!1&&(G.classList.add(n),t=!1),l(Q.value)==!1&&(Q.classList.add(n),t=!1),W(ie.value)==!1&&(ie.classList.add(n),t=!1),Q.value!=""&&G.value==""&&(G.classList.add(n),t=!1),Y.value==""&&(Y.classList.add(n),t=!1),oe.value==""&&(oe.classList.add(n),t=!1),ne.value==""&&(ne.classList.add(n),t=!1),t==!1)return x(O,B);et(),B.innerText="...",B.classList.remove(xe)})}async function Ir(){v(Y,O,B);let e=this.files[0],a=[u(e),Dr(e)];p(a,O,Y,B),m(e,O,Y,B),h(e,Je,Qe)}function Dr(e){return Be(e.type)?`The chosen file mime type ${e.type} is probably not suitable for an upload.`:""}function et(){$r.innerHTML="",Br.innerHTML="",B.innerHTML="",zr.innerHTML="",B.classList.add(xe),O.innerText="",O.classList.add(xe),G.classList.remove(n),Q.classList.remove(n),ie.classList.remove(n),le.classList.remove(n),Y.classList.remove(n),oe.classList.remove(n),ne.classList.remove(n)}(()=>{"use strict";Ee(),fe("demozoo-submission","Demozoo"),fe("pouet-submission","Pou\xEBt"),je("uploader-image-submit"),F("uploader-image-form","uploader-image-progress"),Ne("uploader-intro-submit"),F("uploader-intro-form","uploader-intro-progress"),Ge("uploader-magazine-submit"),F("uploader-magazine-form","uploader-magazine-progress"),Ze("uploader-text-submit"),F("uploader-text-form","uploader-text-progress"),We("uploader-advanced-submit"),F("uploader-advanced-form","uploader-advanced-progress")})();})();
