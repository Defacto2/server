/* editor-archive.min.js */
(()=>{"use strict";const L="text-danger",t="is-invalid",s="is-valid",y="valid-feedback",g="invalid-feedback",l={"Content-type":"application/json; charset=UTF-8"},m="server could not save the change",c=document.getElementById("recordID");if(c==null){console.info("the editor modal is not open so the editor archive script is not needed");return}const n=document.getElementById("edCopyMe");if(n==null){console.info("this file artifact is a single-file so the editor archive script is not needed");return}n.addEventListener("input",function(){if(n.classList.remove(t),n.classList.remove(s),n.value=="")return;const r=document.getElementById("edCopyMeList");if(!Array.from(r.options).some(d=>d.value===n.value)){n.classList.add(t),document.getElementById("edCopyMeErr").textContent="unknown filename",r.classList.remove(t);return}fetch("/editor/readme/copy",{method:"POST",body:JSON.stringify({id:parseInt(c.value),target:n.value}),headers:l}).then(d=>{if(!d.ok)throw new Error(m);return n.classList.add(s),d.json()}).catch(d=>{document.getElementById("edCopyMeErr").textContent=d.message,r.classList.add(t)})}),document.getElementById("edCopyMeReset").addEventListener("click",function(){n.value="",n.classList.remove(t),n.classList.remove(s),a.classList.remove(t),a.classList.remove(s),document.getElementById("edCopyMeList").classList.remove(t)});const a=document.getElementById("edHideMe");a.checked==!0&&(document.getElementById("edHideMeLabel").classList.add(L),n.disabled=!0),a.addEventListener("change",function(){const r=document.getElementById("edHideMeLabel");a.checked==!0?(r.classList.add(L),n.disabled=!0):(r.classList.remove(L),n.disabled=!1),fetch("/editor/readme/hide",{method:"POST",body:JSON.stringify({id:parseInt(c.value),readme:a.checked}),headers:l}).then(e=>{if(!e.ok)throw new Error(m);return a.classList.add(s),e.json()}).catch(e=>{document.getElementById("edHideMeErr").textContent=e.message,a.classList.add(t)})});const o=document.getElementById("edCopyPreview"),u=document.getElementById("edCopyPreviewList"),E=document.getElementById("edCopyPreviewBtn");o.addEventListener("input",function(){o.classList.remove(t),o.classList.remove(s),o.value!=""}),E.addEventListener("click",function(){if(!Array.from(u.options).some(e=>e.value===o.value)){o.classList.add(t),document.getElementById("edCopyPreviewErr").textContent="unknown filename",u.classList.remove(t);return}fetch("/editor/images/copy",{method:"POST",body:JSON.stringify({id:parseInt(c.value),target:o.value}),headers:l}).then(e=>{if(console.log(e),!e.ok)throw console.log("not ok"),new Error(m);return o.classList.add(s),e.json()}).catch(e=>{console.log(e),document.getElementById("edCopyPreviewErr").textContent=e.message,u.classList.add(t)})}),document.getElementById("edCopyPreviewReset").addEventListener("click",function(){o.value="",o.classList.remove(t),o.classList.remove(s),document.getElementById("edCopyPreviewErr").textContent="",u.classList.remove(t)});const i=document.getElementById("edAnsiLove"),v=document.getElementById("edAnsiLoveList"),h=document.getElementById("edAnsiLoveBtn");i.addEventListener("input",function(){i.classList.remove(t),i.classList.remove(s),i.value!=""}),h.addEventListener("click",function(){if(!Array.from(v.options).some(e=>e.value===i.value)){i.classList.add(t),document.getElementById("edAnsiLoveErr").textContent="unknown filename",v.classList.remove(t);return}fetch("/editor/ansilove/copy",{method:"POST",body:JSON.stringify({id:parseInt(c.value),target:i.value}),headers:l}).then(e=>{if(console.log(e),!e.ok)throw console.log("not ok"),new Error(m);return i.classList.add(s),e.json()}).catch(e=>{console.log(e),document.getElementById("edAnsiLoveErr").textContent=e.message,v.classList.add(t)})}),document.getElementById("edAnsiLoveReset").addEventListener("click",function(){i.value="",i.classList.remove(t),i.classList.remove(s),document.getElementById("edAnsiLoveErr").textContent="",v.classList.remove(t)});const f=document.getElementById("edBtnRead");f.disabled=!1,f.addEventListener("click",function(){if(!window.confirm("Delete the readme or textfile?"))return;const r=document.getElementById("edBtnsHide"),e=document.getElementById("edBtnsFeedback");fetch("/editor/readme/delete",{method:"POST",body:JSON.stringify({id:parseInt(c.value)}),headers:l}).then(d=>{if(!d.ok)throw new Error(m);return r.classList.add(s),e.classList.add(y),e.textContent="readme or textfile deleted, refresh the page to see the change",d.json()}).catch(d=>{r.classList.add(t),e.classList.add(g),e.textContent=d.message,console.log(d)})})})();
