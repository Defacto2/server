/* editor-archive.min.js */
(()=>{"use strict";const y="text-danger",t="is-invalid",s="is-valid",m={"Content-type":"application/json; charset=UTF-8"},u="server could not save the change",l=document.getElementById("recordID");if(l==null){console.info("the editor modal is not open so the editor archive script is not needed");return}const n=document.getElementById("edCopyMe");if(n==null){console.info("this file artifact is a single-file so the editor archive script is not needed");return}n.addEventListener("input",function(c){if(n.classList.remove(t),n.classList.remove(s),n.value=="")return;const r=document.getElementById("edCopyMeList");if(!Array.from(r.options).some(d=>d.value===n.value)){n.classList.add(t),document.getElementById("edCopyMeErr").textContent="unknown filename",r.classList.remove(t);return}fetch("/editor/readme/copy",{method:"POST",body:JSON.stringify({id:parseInt(l.value),target:n.value}),headers:m}).then(d=>{if(!d.ok)throw new Error(u);return n.classList.add(s),d.json()}).catch(d=>{document.getElementById("edCopyMeErr").textContent=d.message,r.classList.add(t)})}),document.getElementById("edCopyMeReset").addEventListener("click",function(c){n.value="",n.classList.remove(t),n.classList.remove(s),a.classList.remove(t),a.classList.remove(s),document.getElementById("edCopyMeList").classList.remove(t)});const a=document.getElementById("edHideMe");a.checked==!0&&(document.getElementById("edHideMeLabel").classList.add(y),n.disabled=!0),a.addEventListener("change",function(c){const r=document.getElementById("edHideMeLabel");a.checked==!0?(r.classList.add(y),n.disabled=!0):(r.classList.remove(y),n.disabled=!1),fetch("/editor/readme/hide",{method:"POST",body:JSON.stringify({id:parseInt(l.value),readme:a.checked}),headers:m}).then(e=>{if(!e.ok)throw new Error(u);return a.classList.add(s),e.json()}).catch(e=>{document.getElementById("edHideMeErr").textContent=e.message,a.classList.add(t)})});const o=document.getElementById("edCopyPreview"),v=document.getElementById("edCopyPreviewList"),g=document.getElementById("edCopyPreviewBtn");o.addEventListener("input",function(c){o.classList.remove(t),o.classList.remove(s),o.value!=""}),g.addEventListener("click",function(c){if(!Array.from(v.options).some(e=>e.value===o.value)){o.classList.add(t),document.getElementById("edCopyPreviewErr").textContent="unknown filename",v.classList.remove(t);return}fetch("/editor/images/copy",{method:"POST",body:JSON.stringify({id:parseInt(l.value),target:o.value}),headers:m}).then(e=>{if(console.log(e),!e.ok){throw console.log("not ok"),new Error(u);return}return o.classList.add(s),e.json()}).catch(e=>{console.log(e),document.getElementById("edCopyPreviewErr").textContent=e.message,v.classList.add(t)})}),document.getElementById("edCopyPreviewReset").addEventListener("click",function(){o.value="",o.classList.remove(t),o.classList.remove(s),document.getElementById("edCopyPreviewErr").textContent="",v.classList.remove(t)});const i=document.getElementById("edAnsiLove"),L=document.getElementById("edAnsiLoveList"),E=document.getElementById("edAnsiLoveBtn");i.addEventListener("input",function(c){i.classList.remove(t),i.classList.remove(s),i.value!=""}),E.addEventListener("click",function(c){if(!Array.from(L.options).some(e=>e.value===i.value)){i.classList.add(t),document.getElementById("edAnsiLoveErr").textContent="unknown filename",L.classList.remove(t);return}fetch("/editor/ansilove/copy",{method:"POST",body:JSON.stringify({id:parseInt(l.value),target:i.value}),headers:m}).then(e=>{if(console.log(e),!e.ok){throw console.log("not ok"),new Error(u);return}return i.classList.add(s),e.json()}).catch(e=>{console.log(e),document.getElementById("edAnsiLoveErr").textContent=e.message,L.classList.add(t)})}),document.getElementById("edAnsiLoveReset").addEventListener("click",function(){i.value="",i.classList.remove(t),i.classList.remove(s),document.getElementById("edAnsiLoveErr").textContent="",L.classList.remove(t)});const f=document.getElementById("edBtnRead");f.disabled=!1,f.addEventListener("click",function(c){if(!window.confirm("Delete the readme or textfile?"))return;const r=document.getElementById("edBtnsHide"),e=document.getElementById("edBtnsFeedback");fetch("/editor/readme/delete",{method:"POST",body:JSON.stringify({id:parseInt(l.value)}),headers:m}).then(d=>{if(!d.ok)throw new Error(u);return r.classList.add(s),e.classList.add(fok),e.textContent="readme or textfile deleted, refresh the page to see the change",d.json()}).catch(d=>{r.classList.add(t),e.classList.add(ferr),e.textContent=d.message,console.log(d)})})})();
