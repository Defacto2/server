/* rest-zoo.min.js */
(()=>{"use strict";const f=e=>`${location.protocol}//${location.host}/zoo/prod/${e}`,a=document.getElementById("demozooProdID"),i=document.getElementById("demozooProd"),d=document.getElementById("demozooProdTitle"),l=document.getElementById("demozooProdAuthors"),s=document.getElementById("demozooProdPlat"),u=document.getElementById("demozooProdDate"),r=document.getElementById("demozooProdInvalid"),h=document.getElementById("demozooProdReset"),g=500;let m=null;a.addEventListener("input",T),a.addEventListener("paste",e=>{c(),p(e)}),h.addEventListener("click",c);function T(e){clearTimeout(m),c(),m=setTimeout(()=>{p(e)},g)}function p(e){const t=e.target.value;if(t==="")return;const n=t.match(/\d+/g);if(n===null){r.classList.remove("d-none"),r.innerText="This prod id is invalid";return}const o=n.map(Number);o.length!==0&&(e.target.value=o[0],E(o[0]))}function c(){const e="d-none";i.classList.add(e),r.classList.add(e),d.innerText="",l.innerText="",s.innerText="",u.innerText=""}function E(e){console.info(`Requesting the Demozoo API for production #${e}`),fetch(f(e),{method:"GET",headers:{"Content-Type":"application/json charset=UTF-8"}}).then(t=>{if(!t.ok){const n="A network error occurred requesting API";throw new Error(`${n}: ${t.statusText} ${t.status}`)}return t.json()}).then(t=>{d.innerText=t.title,l.innerText=y(t.author_nicks),s.innerText=v(t.platforms),s.innerText===""&&t.supertype==="graphics"&&(s.innerText="graphic or image"),u.innerText="from "+t.release_date,i.classList.remove("d-none");const n=x(t);n!==""&&(r.classList.remove("d-none"),r.innerText=n)})}function y(e){if(e===null)return"";let t=[];return e.forEach(n=>{n.releaser.is_group&&t.push(n.releaser.name)}),t.length===0?"":"by "+t.join(" + ")}function v(e){if(e===null)return"";let t=[];return e.forEach(n=>{t.push(n.name)}),t.length===0?"":"for "+t.join(" + ")}function x(e){if(e===null)return"result error is null";switch(e.supertype){case"production":break;case"graphics":return"";default:return`production type ${e.supertype} is not allowed`}let t=[];if(e.platforms.forEach(o=>{switch(o.id){case 1:case 4:case 7:case 10:case 46:case 48:case 84:case 94:t.push(o.name);break}}),t.length===0)return"platform is not allowed";let n=[];return e.types.forEach(o=>{switch(o.id){case 1:case 4:case 5:case 6:case 9:case 13:case 23:case 24:case 25:case 26:case 27:case 34:case 36:case 41:case 47:case 49:case 51:n.push(o.name);break}}),n.length===0?"production type is not allowed":""}})();
