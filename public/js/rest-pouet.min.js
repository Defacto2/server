/* rest-pouet.min.js */
(()=>{"use strict";const g=t=>`${location.protocol}//${location.host}/pouet/prod/${t}`,a=document.getElementById("pouetProdsID"),s=document.getElementById("pouetProd"),u=document.getElementById("pouetProdTitle"),m=document.getElementById("pouetProdGroups"),p=document.getElementById("pouetProdPlat"),f=document.getElementById("pouetProdDate"),n=document.getElementById("pouetProdInvalid"),E=document.getElementById("pouetProdReset"),i=document.getElementById("pouetSubmit"),r="d-none",d="This prod id is not valid",h=199999,x=500;let T=null;a.addEventListener("input",y),a.addEventListener("paste",t=>{l(),v(t)}),E.addEventListener("click",l),i.addEventListener("click",function(t){document.getElementById("pouetUploader").submit()});function y(t){clearTimeout(T),l(),t.target.value!==""&&(s.classList.remove(r),u.innerText=`Will lookup ${t.target.value}...`),T=setTimeout(()=>{s.classList.add(r),u.innerText="",v(t)},x)}function v(t){const e=t.target.value;if(e===""){i.disabled=!0;return}const o=e.match(/\d+/g);if(o===null){n.classList.remove(r),n.innerText=d;return}const c=o.map(Number);if(c.length!==0){if(c[0]>h){n.classList.remove(r),n.innerText=d;return}t.target.value=c[0],I(c[0])}}function l(){i.disabled=!0,s.classList.add(r),n.classList.add(r),u.innerText="",m.innerText="",p.innerText="",f.innerText=""}function I(t){console.info(`Requesting the Pou\xEBt API for production #${t}`),fetch(g(t),{method:"GET",headers:{"Content-Type":"application/json charset=UTF-8"}}).then(e=>{if(!e.ok){if(i.disabled=!0,n.classList.remove(r),e.status===404){n.innerText=d+` ${t}`;return}const o="A network error occurred requesting API";throw n.innerText=`${o}: ${e.statusText}`,new Error(`${o}: ${e.statusText} ${e.status}`)}return e.json()}).then(e=>{if(u.innerText=e.title,m.innerText=L(e.groups),p.innerText="the "+e.platform+P(e.types),f.innerText="from "+e.release_date,s.classList.remove(r),e.valid!==!0){i.disabled=!0,n.classList.remove(r),n.innerText=d;return}i.disabled=!1}).catch(e=>{typeof e>"u"||console.error(e)})}function L(t){if(t===null)return"";let e=[];return t.forEach(o=>{e.push(o.name)}),e.length===0?"":"by "+e.join(" + ")}function P(t){if(t===null)return"";let e=[];return t.forEach(o=>{e.push(o)}),e.length===0?"":" "+e.join(" + ")}})();
