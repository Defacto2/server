/* rest-pouet.min.js */
(()=>{"use strict";const f=e=>`${location.protocol}//${location.host}/pouet/prod/${e}`,o=document.getElementById("pouetProdsID"),i=document.getElementById("pouetProd"),c=document.getElementById("pouetProdTitle"),d=document.getElementById("pouetProdGroups"),l=document.getElementById("pouetProdPlat"),a=document.getElementById("pouetProdDate"),r=document.getElementById("pouetProdInvalid"),y=document.getElementById("pouetProdReset"),g=500;let m=null;o.addEventListener("input",h),o.addEventListener("paste",e=>{s(),p(e)}),o.addEventListener("click",s);function h(e){console.log("parseEvent",e),clearTimeout(m),s(),m=setTimeout(()=>{p(e)},g)}function p(e){const n=e.target.value.match(/\d+/g);if(n===null){console.log("no numbers");return}const u=n.map(Number);if(u.length===0){console.log("no numbers");return}e.target.value=u[0],E(u[0])}function s(){const e="d-none";i.classList.add(e),r.classList.add(e),c.innerText="",d.innerText="",l.innerText="",a.innerText=""}function E(e){console.info(`Requesting the Pou\xEBt API for production #${e}`),fetch(f(e),{method:"GET",headers:{"Content-Type":"application/json charset=UTF-8"}}).then(t=>{if(!t.ok){const n="A network error occurred requesting API";throw new Error(`${n}: ${t.statusText} ${t.status}`)}return t.json()}).then(t=>{c.innerText=t.title,d.innerText=T(t.groups),l.innerText="on "+t.platform+v(t.types),a.innerText="from "+t.release_date,i.classList.remove("d-none"),t.valid!==!0&&(r.classList.remove("d-none"),r.innerText="This prod is not valid")})}function T(e){if(e===null)return"";let t=[];return e.forEach(n=>{t.push(n.name)}),t.length===0?"":"by "+t.join(" + ")}function v(e){if(e===null)return"";let t=[];return e.forEach(n=>{t.push(n)}),t.length===0?"":" "+t.join(" + ")}})();
