/* rest-pouet.min.js */
(()=>{"use strict";const f=t=>`${location.protocol}//${location.host}/pouet/prod/${t}`,s=document.getElementById("pouetProdsID"),u=document.getElementById("pouetProd"),d=document.getElementById("pouetProdTitle"),c=document.getElementById("pouetProdGroups"),l=document.getElementById("pouetProdPlat"),a=document.getElementById("pouetProdDate"),o=document.getElementById("pouetProdInvalid"),h=document.getElementById("pouetProdReset"),T=500;let m=null;s.addEventListener("input",g),s.addEventListener("paste",t=>{r(),p(t)}),h.addEventListener("click",r);function g(t){clearTimeout(m),r(),m=setTimeout(()=>{p(t)},T)}function p(t){const e=t.target.value;if(e==="")return;const n=e.match(/\d+/g);if(n===null){o.classList.remove("d-none"),o.innerText="This prod id is invalid";return}const i=n.map(Number);i.length!==0&&(t.target.value=i[0],E(i[0]))}function r(){const t="d-none";u.classList.add(t),o.classList.add(t),d.innerText="",c.innerText="",l.innerText="",a.innerText=""}function E(t){console.info(`Requesting the Pou\xEBt API for production #${t}`),fetch(f(t),{method:"GET",headers:{"Content-Type":"application/json charset=UTF-8"}}).then(e=>{if(!e.ok){const n="A network error occurred requesting API";throw new Error(`${n}: ${e.statusText} ${e.status}`)}return e.json()}).then(e=>{d.innerText=e.title,c.innerText=v(e.groups),l.innerText="on "+e.platform+y(e.types),a.innerText="from "+e.release_date,u.classList.remove("d-none"),e.valid!==!0&&(o.classList.remove("d-none"),o.innerText="This prod is not valid")})}function v(t){if(t===null)return"";let e=[];return t.forEach(n=>{e.push(n.name)}),e.length===0?"":"by "+e.join(" + ")}function y(t){if(t===null)return"";let e=[];return t.forEach(n=>{e.push(n)}),e.length===0?"":" "+e.join(" + ")}})();
