/* rest-pouet.min.js */
(()=>{"use strict";const f=e=>`${location.protocol}//${location.host}/pouet/prod/${e}`,u=document.getElementById("pouetProdsID"),i=document.getElementById("pouetProd"),c=document.getElementById("pouetProdTitle"),d=document.getElementById("pouetProdGroups"),l=document.getElementById("pouetProdPlat"),a=document.getElementById("pouetProdDate"),o=document.getElementById("pouetProdInvalid"),g=document.getElementById("pouetProdReset"),h=500;let m=null;u.addEventListener("input",E),u.addEventListener("paste",e=>{r(),p(e)}),g.addEventListener("click",r);function E(e){console.log("parseEvent",e),clearTimeout(m),r(),m=setTimeout(()=>{p(e)},h)}function p(e){const n=e.target.value.match(/\d+/g);if(n===null){console.log("no numbers");return}const s=n.map(Number);if(s.length===0){console.log("no numbers");return}e.target.value=s[0],T(s[0])}function r(){const e="d-none";i.classList.add(e),o.classList.add(e),c.innerText="",d.innerText="",l.innerText="",a.innerText=""}function T(e){console.info(`Requesting the Pou\xEBt API for production #${e}`),fetch(f(e),{method:"GET",headers:{"Content-Type":"application/json charset=UTF-8"}}).then(t=>{if(!t.ok){const n="A network error occurred requesting API";throw new Error(`${n}: ${t.statusText} ${t.status}`)}return t.json()}).then(t=>{c.innerText=t.title,d.innerText=v(t.groups),l.innerText="on "+t.platform+y(t.types),a.innerText="from "+t.release_date,i.classList.remove("d-none"),t.valid!==!0&&(o.classList.remove("d-none"),o.innerText="This prod is not valid")})}function v(e){if(e===null)return"";let t=[];return e.forEach(n=>{t.push(n.name)}),t.length===0?"":"by "+t.join(" + ")}function y(e){if(e===null)return"";let t=[];return e.forEach(n=>{t.push(n)}),t.length===0?"":" "+t.join(" + ")}})();
