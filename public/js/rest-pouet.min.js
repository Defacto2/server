/* rest-pouet.min.js */
(()=>{"use strict";const g=t=>`${location.protocol}//${location.host}/pouet/prod/${t}`,a=document.getElementById("pouetProdsID"),i=document.getElementById("pouetProd"),s=document.getElementById("pouetProdTitle"),m=document.getElementById("pouetProdGroups"),p=document.getElementById("pouetProdPlat"),f=document.getElementById("pouetProdDate"),n=document.getElementById("pouetProdInvalid"),E=document.getElementById("pouetProdReset"),u=document.getElementById("pouetSubmit"),o="d-none",c="This prod id is not valid",h=199999,x=500;let T=null;a.addEventListener("input",y),a.addEventListener("paste",t=>{l(),v(t)}),E.addEventListener("click",l),u.addEventListener("click",function(t){document.getElementById("pouetUploader").submit()});function y(t){clearTimeout(T),l(),t.target.value!==""&&(i.classList.remove(o),s.innerText=`Will lookup ${t.target.value}...`),T=setTimeout(()=>{i.classList.add(o),s.innerText="",v(t)},x)}function v(t){const e=t.target.value;if(e===""){u.disabled=!0;return}const r=e.match(/\d+/g);if(r===null){n.classList.remove(o),n.innerText=c;return}const d=r.map(Number);if(d.length!==0){if(d[0]>h){n.classList.remove(o),n.innerText=c;return}t.target.value=d[0],I(d[0])}}function l(){i.classList.add(o),n.classList.add(o),s.innerText="",m.innerText="",p.innerText="",f.innerText=""}function I(t){console.info(`Requesting the Pou\xEBt API for production #${t}`),fetch(g(t),{method:"GET",headers:{"Content-Type":"application/json charset=UTF-8"}}).then(e=>{if(!e.ok){if(u.disabled=!0,n.classList.remove(o),e.status===404){n.innerText=c+` ${t}`;return}const r="A network error occurred requesting API";throw n.innerText=`${r}: ${e.statusText}`,new Error(`${r}: ${e.statusText} ${e.status}`)}return e.json()}).then(e=>{if(s.innerText=e.title,m.innerText=L(e.groups),p.innerText="the "+e.platform+P(e.types),f.innerText="from "+e.release_date,i.classList.remove(o),e.valid!==!0){u.disabled=!0,n.classList.remove(o),n.innerText=c;return}}).catch(e=>{typeof e>"u"||console.error(e)})}function L(t){if(t===null)return"";let e=[];return t.forEach(r=>{e.push(r.name)}),e.length===0?"":"by "+e.join(" + ")}function P(t){if(t===null)return"";let e=[];return t.forEach(r=>{e.push(r)}),e.length===0?"":" "+e.join(" + ")}})();
