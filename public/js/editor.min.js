/* editor.min.js */
(()=>{"use strict";const L="text-danger",e="is-invalid",u="is-valid",B="d-none",x={"Content-type":"application/json; charset=UTF-8"},R="server could not save the change",w=document.getElementById("recordID");if(w==null){console.info("the editor modal is not open so the editor script is not needed");return}const b=document.getElementById("recordOnline"),T=document.getElementById("recordOnlineLabel");b.checked!=!0&&T.classList.add(L),b.addEventListener("change",function(){let t="/editor/online/false";b.checked==!0&&(t="/editor/online/true"),fetch(t,{method:"POST",body:JSON.stringify({id:parseInt(w.value)}),headers:x}).then(s=>{if(!s.ok)throw new Error(R);return b.checked==!0?T.classList.remove(L):T.classList.add(L),s.json()}).catch(s=>{console.log(s.message)})});const h=document.getElementById("recordTitle");h.addEventListener("input",function(){const t=document.getElementById("recordTitleErr"),s=document.getElementById("recordTitleOG"),v=document.getElementById("recordTitleOGValue").textContent;h.value!=v&&h.value.length>0?s.classList.remove(B):s.classList.add(B),h.classList.remove(e),t.classList.add(B),fetch("/editor/title",{method:"POST",body:JSON.stringify({id:parseInt(w.value),value:h.value}),headers:x}).then(p=>{if(!p.ok)throw new Error(R);return t.classList.add(B),h.classList.remove(e),h.classList.add(u),p.json()}).catch(p=>{t.classList.remove(B),h.classList.add(e),console.log(p.message)})});const l=document.getElementById("recordYMDSave");l.addEventListener("click",function(){c.classList.remove(u),r.classList.remove(u),n.classList.remove(u),fetch("/editor/ymd",{method:"POST",body:JSON.stringify({id:parseInt(w.value),year:parseInt(c.value),month:parseInt(r.value),day:parseInt(n.value)}),headers:x}).then(t=>{if(!t.ok)throw new Error(R);return c.classList.add(u),r.classList.add(u),n.classList.add(u),l.classList.remove(L),t.json()}).catch(t=>{l.classList.add(L),console.log(t.message)})}),document.getElementById("recordLMBtn").addEventListener("click",function(){c.classList.remove(e),r.classList.remove(e),n.classList.remove(e),c.classList.remove(u),r.classList.remove(u),n.classList.remove(u);const t=document.getElementById("recordLastMod").value.split("-");if(t.length!=3){console.error("invalid last modified date provided by server");return}c.value=t[0],r.value=t[1],n.value=t[2]}),document.getElementById("recordYMDReset").addEventListener("click",function(){const t=document.getElementById("recordOgY").value,s=document.getElementById("recordOgM").value,v=document.getElementById("recordOgD").value;c.value=t,r.value=s,n.value=v,c.classList.remove(e),r.classList.remove(e),n.classList.remove(e),c.classList.remove(u),r.classList.remove(u),n.classList.remove(u),l.disabled=!1});const c=document.getElementById("recordYear"),r=document.getElementById("recordMonth"),n=document.getElementById("recordDay");c.addEventListener("input",function(){if(c.value>=1980&&c.value<=2023){c.classList.remove(e),l.disabled=!1;return}if(c.value==""&&r.value==""&&n.value==""){c.classList.remove(e),r.classList.remove(e),n.classList.remove(e),l.disabled=!1;return}c.classList.add(e),l.disabled=!0}),r.addEventListener("input",function(){if(r.value>=1&&r.value<=12){r.classList.remove(e),l.disabled=!1;return}if(c.value==""&&r.value==""&&n.value==""){c.classList.remove(e),r.classList.remove(e),n.classList.remove(e),l.disabled=!1;return}if(r.value==""&&n.value==""){r.classList.remove(e),n.classList.remove(e),l.disabled=!1;return}r.classList.add(e),l.disabled=!0}),n.addEventListener("input",function(){if(n.value>=1&&n.value<=31){n.classList.remove(e),l.disabled=!1;return}if(c.value==""&&r.value==""&&n.value==""){c.classList.remove(e),r.classList.remove(e),n.classList.remove(e),l.disabled=!1;return}if(r.value==""&&n.value==""){r.classList.remove(e),n.classList.remove(e),l.disabled=!1;return}if(n.value==""){n.classList.remove(e),l.disabled=!1;return}n.classList.add(e),l.disabled=!0});const m=document.getElementById("recordReleasers"),S=document.getElementById("recordReleasersMax");m.addEventListener("input",function(){if(m.value=m.value.toUpperCase(),m.value=m.value.replace(/[^a-zA-Z0-9-+& ]/g,""),m.value==""){m.classList.add(e);return}m.classList.remove(e),m.value.split("+").length>2?(m.classList.add(e),S.classList.add(L)):(m.classList.remove(e),S.classList.remove(L))});function O(t){let s=t;return s=s.toLowerCase(),s=s.replace(/[^A-Za-z0-9À-ÖØ-öø-ÿ\s,]/g,""),s}const j=document.getElementById("recordArtist"),M=document.getElementById("recordCoder"),z=document.getElementById("recordMusic"),U=document.getElementById("recordWriter");j.addEventListener("input",function(){j.value=O(j.value)}),M.addEventListener("input",function(){M.value=O(M.value)}),z.addEventListener("input",function(){z.value=O(z.value)}),U.addEventListener("input",function(){U.value=O(U.value)});const i=document.getElementById("recordDemozoo");i.addEventListener("paste",function(){setTimeout(()=>{try{if(new URL(`${i.value}`).hostname!="demozoo.org"){i.classList.add(e);return}}catch{return}try{const v=new URL(`${i.value}`).pathname.split("/").filter(Boolean);if(v.length!=2){i.classList.add(e);return}switch(v[0]){case"productions":i.value=v[1];break;case"graphics":i.value=v[1];break;default:i.classList.add(e);return}i.classList.remove(e)}catch{i.classList.add(e)}},0)}),i.addEventListener("input",function(){let t=Number(i.value);if(isNaN(t)){i.classList.add(e);return}if(t<0||t>999999){i.classList.add(e);return}t==0&&(i.value=""),i.classList.remove(e)});const d=document.getElementById("recordPouet");d.addEventListener("paste",function(){setTimeout(()=>{try{const t=new URL(`${d.value}`);if(console.log(t.hostname),t.hostname!="www.pouet.net"){d.classList.add(e);return}}catch{return}try{const t=new URL(`${d.value}`);if(t.pathname!="/prod.php"){d.classList.add(e);return}const p=new URLSearchParams(t.search).get("which");d.value=p,d.classList.remove(e)}catch{d.classList.add(e)}},0)}),d.addEventListener("input",function(){let t=Number(d.value);if(isNaN(t)){d.classList.add(e);return}if(t<0||t>199999){d.classList.add(e);return}t==0&&(d.value=""),d.classList.remove(e)});const y=document.getElementById("record16colors");y.addEventListener("paste",function(){setTimeout(()=>{try{const t=new URL(`${y.value}`);if(t.hostname!="16colo.rs"){y.classList.add(e);return}const s=t.pathname;y.value=s,y.classList.remove(e)}catch{}},0)}),y.addEventListener("input",function(){if(y.value==""){y.classList.remove(e);return}});const g=document.getElementById("recordGitHub");g.addEventListener("paste",function(){setTimeout(()=>{try{const t=new URL(`${g.value}`);if(t.hostname!="github.com"){g.classList.add(e);return}const s=t.pathname;g.value=s,g.classList.remove(e)}catch{}},0)}),g.addEventListener("input",function(){if(g.value==""){g.classList.remove(e);return}});const f=document.getElementById("recordYouTube");f.addEventListener("paste",function(){setTimeout(()=>{try{const t=new URL(`${f.value}`);if(t.hostname!="youtube.com"&&t.hostname!="www.youtube.com"){f.classList.add(e);return}const v=new URLSearchParams(t.search).get("v");f.value=v,g.classList.remove(e)}catch{}},0)}),f.addEventListener("input",function(){setTimeout(()=>{if(f.value==""){f.classList.remove(e);return}if(new RegExp("^[a-zA-Z0-9_-]{11}$").test(f.value)){f.classList.remove(e);return}f.classList.add(e)},0)});const I=document.getElementById("recordFilename");I.addEventListener("input",function(){if(I.value=I.value.trimStart(),I.value==""){I.classList.add(e);return}I.classList.remove(e)});const o=document.getElementById("recordPlatform"),a=document.getElementById("recordTag");o.addEventListener("change",function(t){if(o.classList.remove(e),t.target.value.length==0){o.classList.add(e);return}}),a.addEventListener("change",function(t){if(a.classList.remove(e),t.target.value.length==0){a.classList.add(e);return}}),document.getElementById("recTagsReset").addEventListener("click",function(){const t=document.getElementById("recOSOg").value,s=document.getElementById("recTagOg").value;o.value=t,a.value=s,o.classList.remove(e),a.classList.remove(e),o.value.length==0&&o.classList.add(e),a.value.length==0&&a.classList.add(e)});const D=document.getElementById("recordReleasersLabel"),N=document.getElementById("recordTitleLabel");a.addEventListener("change",function(){setTimeout(()=>{if(a.value=="magazine"){k();return}E()},0)});function k(){D.textContent="Magazine",N.textContent="Issue"}function E(){D.textContent="Releasers",N.textContent="Title"}document.getElementById("recordDosText").addEventListener("click",function(){o.value="text",o.classList.remove(e),a.value="",a.classList.add(e),E()}),document.getElementById("recordAmigaText").addEventListener("click",function(){o.value="textamiga",o.classList.remove(e),a.value="",a.classList.add(e),E()}),document.getElementById("recordProof").addEventListener("click",function(){o.value="image",o.classList.remove(e),a.value="releaseproof",a.classList.remove(e),E()}),document.getElementById("recordDostro").addEventListener("click",function(){o.value="dos",o.classList.remove(e),a.value="releaseadvert",a.classList.remove(e),E()}),document.getElementById("recordWintro").addEventListener("click",function(){o.value="windows",o.classList.remove(e),a.value="releaseadvert",a.classList.remove(e),E()}),document.getElementById("recordBBStro").addEventListener("click",function(){o.value="dos",o.classList.remove(e),a.value="bbs",a.classList.remove(e),E()}),document.getElementById("recordBBSAnsi").addEventListener("click",function(){o.value="ansi",o.classList.remove(e),a.value="bbs",a.classList.remove(e),E()}),document.getElementById("recordTextMag").addEventListener("click",function(){o.value="text",a.value="magazine",k()}),document.getElementById("recordDosMag").addEventListener("click",function(){o.value="dos",o.classList.remove(e),a.value="magazine",a.classList.remove(e),k()}),document.getElementById("recordReset").addEventListener("click",function(){setTimeout(()=>{b.checked!=!0?T.classList.add(L):T.classList.remove(L),S.classList.remove(L),a.value=="magazine"?k():E(),document.querySelectorAll("input").forEach(s=>{s.classList.remove(e)},0)})})})();
