/* editor.min.js */
(()=>{"use strict";const B="text-danger",t="is-invalid",i="is-valid",C="valid-feedback",P="invalid-feedback",b="d-none",R={"Content-type":"application/json; charset=UTF-8"},k=document.getElementById("recordID");if(k==null){console.info("the editor modal is not open so the editor script is not needed");return}const T=document.getElementById("recordOnline"),w=document.getElementById("recordOnlineLabel");T.checked!=!0&&w.classList.add(B),T.addEventListener("change",function(s){let e="/editor/online/false";T.checked==!0&&(e="/editor/online/true"),fetch(e,{method:"POST",body:JSON.stringify({id:parseInt(k.value)}),headers:R}).then(o=>{if(!o.ok)throw new Error(saveErr);return T.checked==!0?w.classList.remove(B):w.classList.add(B),o.json()}).catch(o=>{console.log(o.message)})});const y=document.getElementById("recordTitle");y.addEventListener("input",function(s){const e=document.getElementById("recordTitleErr"),o=document.getElementById("recordTitleOG"),m=document.getElementById("recordTitleOGValue").textContent;y.value!=m&&y.value.length>0?o.classList.remove(b):o.classList.add(b),y.classList.remove(t),e.classList.add(b),fetch("/editor/title",{method:"POST",body:JSON.stringify({id:parseInt(k.value),value:y.value}),headers:R}).then(p=>{if(!p.ok)throw new Error(saveErr);return e.classList.add(b),y.classList.remove(t),y.classList.add(i),p.json()}).catch(p=>{e.classList.remove(b),y.classList.add(t),console.log(p.message)})});const c=document.getElementById("recordYMDSave");c.addEventListener("click",function(s){r.classList.remove(i),a.classList.remove(i),n.classList.remove(i),fetch("/editor/ymd",{method:"POST",body:JSON.stringify({id:parseInt(k.value),year:parseInt(r.value),month:parseInt(a.value),day:parseInt(n.value)}),headers:R}).then(e=>{if(!e.ok)throw new Error(saveErr);return r.classList.add(i),a.classList.add(i),n.classList.add(i),c.classList.remove(B),e.json()}).catch(e=>{c.classList.add(B),console.log(e.message)})}),document.getElementById("recordLMBtn").addEventListener("click",function(s){r.classList.remove(t),a.classList.remove(t),n.classList.remove(t),r.classList.remove(i),a.classList.remove(i),n.classList.remove(i);const e=document.getElementById("recordLastMod").value.split("-");if(e.length!=3){console.error("invalid last modified date provided by server");return}r.value=e[0],a.value=e[1],n.value=e[2]}),document.getElementById("recordYMDReset").addEventListener("click",function(s){const e=document.getElementById("recordOgY").value,o=document.getElementById("recordOgM").value,m=document.getElementById("recordOgD").value;r.value=e,a.value=o,n.value=m,r.classList.remove(t),a.classList.remove(t),n.classList.remove(t),r.classList.remove(i),a.classList.remove(i),n.classList.remove(i),c.disabled=!1});const r=document.getElementById("recordYear"),a=document.getElementById("recordMonth"),n=document.getElementById("recordDay");r.addEventListener("input",function(s){if(r.value>=1980&&r.value<=2023){r.classList.remove(t),c.disabled=!1;return}if(r.value==""&&a.value==""&&n.value==""){r.classList.remove(t),a.classList.remove(t),n.classList.remove(t),c.disabled=!1;return}r.classList.add(t),c.disabled=!0}),a.addEventListener("input",function(s){if(a.value>=1&&a.value<=12){a.classList.remove(t),c.disabled=!1;return}if(r.value==""&&a.value==""&&n.value==""){r.classList.remove(t),a.classList.remove(t),n.classList.remove(t),c.disabled=!1;return}if(a.value==""&&n.value==""){a.classList.remove(t),n.classList.remove(t),c.disabled=!1;return}a.classList.add(t),c.disabled=!0}),n.addEventListener("input",function(s){if(n.value>=1&&n.value<=31){n.classList.remove(t),c.disabled=!1;return}if(r.value==""&&a.value==""&&n.value==""){r.classList.remove(t),a.classList.remove(t),n.classList.remove(t),c.disabled=!1;return}if(a.value==""&&n.value==""){a.classList.remove(t),n.classList.remove(t),c.disabled=!1;return}if(n.value==""){n.classList.remove(t),c.disabled=!1;return}n.classList.add(t),c.disabled=!0});const v=document.getElementById("recordReleasers"),S=document.getElementById("recordReleasersMax");v.addEventListener("input",function(s){if(v.value=v.value.toUpperCase(),v.value=v.value.replace(/[^a-zA-Z0-9-+& ]/g,""),v.value==""){v.classList.add(t);return}v.classList.remove(t),v.value.split("+").length>2?(v.classList.add(t),S.classList.add(dang)):(v.classList.remove(t),S.classList.remove(dang))});function O(s){let e=s;return e=e.toLowerCase(),e=e.replace(/[^A-Za-z0-9À-ÖØ-öø-ÿ\s,]/g,""),e}const j=document.getElementById("recordArtist"),M=document.getElementById("recordCoder"),z=document.getElementById("recordMusic"),U=document.getElementById("recordWriter");j.addEventListener("input",function(s){j.value=O(j.value)}),M.addEventListener("input",function(s){M.value=O(M.value)}),z.addEventListener("input",function(s){z.value=O(z.value)}),U.addEventListener("input",function(s){U.value=O(U.value)});const d=document.getElementById("recordDemozoo");d.addEventListener("paste",function(s){setTimeout(()=>{try{if(new URL(`${d.value}`).hostname!="demozoo.org"){d.classList.add(t);return}}catch{return}try{const m=new URL(`${d.value}`).pathname.split("/").filter(Boolean);if(m.length!=2){d.classList.add(t);return}switch(m[0]){case"productions":d.value=m[1];break;case"graphics":d.value=m[1];break;default:d.classList.add(t);return}d.classList.remove(t)}catch{d.classList.add(t)}},0)}),d.addEventListener("input",function(s){let e=Number(d.value);if(isNaN(e)){d.classList.add(t);return}if(e<0||e>999999){d.classList.add(t);return}e==0&&(d.value=""),d.classList.remove(t)});const l=document.getElementById("recordPouet");l.addEventListener("paste",function(s){setTimeout(()=>{try{const e=new URL(`${l.value}`);if(console.log(e.hostname),e.hostname!="www.pouet.net"){l.classList.add(t);return}}catch{return}try{const e=new URL(`${l.value}`);if(e.pathname!="/prod.php"){l.classList.add(t);return}const p=new URLSearchParams(e.search).get("which");l.value=p,l.classList.remove(t)}catch{l.classList.add(t)}},0)}),l.addEventListener("input",function(s){let e=Number(l.value);if(isNaN(e)){l.classList.add(t);return}if(e<0||e>199999){l.classList.add(t);return}e==0&&(l.value=""),l.classList.remove(t)});const h=document.getElementById("record16colors");h.addEventListener("paste",function(s){setTimeout(()=>{try{const e=new URL(`${h.value}`);if(e.hostname!="16colo.rs"){h.classList.add(t);return}const o=e.pathname;h.value=o,h.classList.remove(t)}catch{}},0)}),h.addEventListener("input",function(s){if(h.value==""){h.classList.remove(t);return}});const g=document.getElementById("recordGitHub");g.addEventListener("paste",function(s){setTimeout(()=>{try{const e=new URL(`${g.value}`);if(e.hostname!="github.com"){g.classList.add(t);return}const o=e.pathname;g.value=o,g.classList.remove(t)}catch{}},0)}),g.addEventListener("input",function(s){if(g.value==""){g.classList.remove(t);return}});const L=document.getElementById("recordYouTube");L.addEventListener("paste",function(s){setTimeout(()=>{try{const e=new URL(`${L.value}`);if(e.hostname!="youtube.com"&&e.hostname!="www.youtube.com"){L.classList.add(t);return}const m=new URLSearchParams(e.search).get("v");L.value=m,g.classList.remove(t)}catch{}},0)}),L.addEventListener("input",function(s){setTimeout(()=>{if(L.value==""){L.classList.remove(t);return}if(new RegExp("^[a-zA-Z0-9_-]{11}$").test(L.value)){L.classList.remove(t);return}L.classList.add(t)},0)});const I=document.getElementById("recordFilename");I.addEventListener("input",function(){if(I.value=I.value.trimStart(),I.value==""){I.classList.add(t);return}I.classList.remove(t)});const f=document.getElementById("recordPlatform"),u=document.getElementById("recordTag");document.getElementById("recTagsReset").addEventListener("click",function(){const s=document.getElementById("recOSOg").value,e=document.getElementById("recTagOg").value;f.value=s,u.value=e});const D=document.getElementById("recordReleasersLabel"),N=document.getElementById("recordTitleLabel");u.addEventListener("change",function(s){setTimeout(()=>{if(u.value=="magazine"){x();return}E()},0)});function x(){D.textContent="Magazine",N.textContent="Issue"}function E(){D.textContent="Releasers",N.textContent="Title"}document.getElementById("recordDosText").addEventListener("click",function(s){f.value="text",u.value="",E()}),document.getElementById("recordAmigaText").addEventListener("click",function(s){f.value="textamiga",u.value="",E()}),document.getElementById("recordProof").addEventListener("click",function(s){f.value="image",u.value="releaseproof",E()}),document.getElementById("recordDostro").addEventListener("click",function(s){f.value="dos",u.value="releaseadvert",E()}),document.getElementById("recordWintro").addEventListener("click",function(s){f.value="windows",u.value="releaseadvert",E()}),document.getElementById("recordBBStro").addEventListener("click",function(s){f.value="dos",u.value="bbs",E()}),document.getElementById("recordBBSAnsi").addEventListener("click",function(s){f.value="ansi",u.value="bbs",E()}),document.getElementById("recordTextMag").addEventListener("click",function(s){f.value="text",u.value="magazine",x()}),document.getElementById("recordDosMag").addEventListener("click",function(s){f.value="dos",u.value="magazine",x()}),document.getElementById("recordReset").addEventListener("click",function(s){setTimeout(()=>{T.checked!=!0?w.classList.add(dang):w.classList.remove(dang),S.classList.remove(dang),u.value=="magazine"?x():E(),document.querySelectorAll("input").forEach(o=>{o.classList.remove(t)},0)})})})();
