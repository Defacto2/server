/* editor-assets.min.js */
(()=>{"use strict";const m="text-danger",t="is-invalid",n="is-valid",y="valid-feedback",E="invalid-feedback",v={"Content-type":"application/json; charset=UTF-8"},f="server could not save the change",u=document.getElementById("recordID");if(u==null){console.info("the editor modal is not open so this script is not needed");return}document.getElementById("edBtnRead").addEventListener("click",function(i){if(!window.confirm("Delete the readme or textfile?"))return;const c=document.getElementById("edBtnsHide"),e=document.getElementById("edBtnsFeedback");fetch("/editor/readme/delete",{method:"POST",body:JSON.stringify({id:parseInt(u.value)}),headers:v}).then(s=>{if(!s.ok)throw new Error(f);return c.classList.add(n),e.classList.add(y),e.textContent="readme or textfile deleted, refresh the page to see the change",s.json()}).catch(s=>{c.classList.add(t),e.classList.add(E),e.textContent=s.message,console.log(s)})}),document.getElementById("edBtnImgs").addEventListener("click",function(i){if(!window.confirm("Delete the previews and thumbnail?"))return;const c=document.getElementById("edBtnsHide"),e=document.getElementById("edBtnsFeedback");fetch("/editor/images/delete",{method:"POST",body:JSON.stringify({id:parseInt(u.value)}),headers:v}).then(s=>{if(!s.ok)throw new Error(f);return c.classList.add(n),e.classList.add(y),e.textContent="images deleted, refresh the page to see the change",s.json()}).catch(s=>{c.classList.add(t),e.classList.add(E),e.textContent=s.message})});const d=document.getElementById("edCopyMe");d.addEventListener("input",function(i){if(d.classList.remove(t),d.classList.remove(n),d.value=="")return;const c=document.getElementById("edCopyMeList");if(!Array.from(c.options).some(s=>s.value===d.value)){d.classList.add(t);return}fetch("/editor/readme/copy",{method:"POST",body:JSON.stringify({id:parseInt(u.value),target:d.value}),headers:v}).then(s=>{if(!s.ok)throw new Error(f);return d.classList.add(n),s.json()}).catch(s=>{document.getElementById("edCopyMeErr").textContent=s.message,c.classList.add(t)})}),document.getElementById("edCopyMeReset").addEventListener("click",function(i){d.value="",d.classList.remove(t),d.classList.remove(n),l.classList.remove(t),l.classList.remove(n)});const l=document.getElementById("edHideMe");l.checked==!0&&(document.getElementById("edHideMeLabel").classList.add(m),d.disabled=!0),l.addEventListener("change",function(i){const c=document.getElementById("edHideMeLabel");l.checked==!0?(c.classList.add(m),d.disabled=!0):(c.classList.remove(m),d.disabled=!1),fetch("/editor/readme/hide",{method:"POST",body:JSON.stringify({id:parseInt(u.value),readme:l.checked}),headers:v}).then(e=>{if(!e.ok)throw new Error(f);return l.classList.add(n),e.json()}).catch(e=>{document.getElementById("edHideMeErr").textContent=e.message,l.classList.add(t)})});const a=document.getElementById("recordPreview"),L=document.getElementById("recordPreviewList"),B=document.getElementById("recordPreviewBtn");a.addEventListener("input",function(i){a.classList.remove(t),a.classList.remove(n),a.value!=""}),B.addEventListener("click",function(i){if(!Array.from(L.options).some(e=>e.value===a.value)){a.classList.add(t),document.getElementById("edCopyImgsErr").textContent="unknown filename",L.classList.remove(t);return}fetch("/editor/images/copy",{method:"POST",body:JSON.stringify({id:parseInt(u.value),target:a.value}),headers:v}).then(e=>{if(console.log(e),!e.ok){throw console.log("not ok"),new Error(f);return}return a.classList.add(n),e.json()}).catch(e=>{console.log(e),document.getElementById("edCopyImgsErr").textContent=e.message,L.classList.add(t)})}),document.getElementById("edCopyImgsReset").addEventListener("click",function(){a.value="",a.classList.remove(t),a.classList.remove(n),document.getElementById("edCopyImgsErr").textContent="",L.classList.remove(t)});const r=document.getElementById("recordPreviewUp"),I=document.getElementById("recordPreviewUpBtn"),p=document.getElementById("recordPreviewUpReset");r.addEventListener("change",function(i){r.value!=""&&r.classList.remove(t)}),I.addEventListener("click",function(i){if(r.value==""){r.classList.add(t),r.classList.remove(n);return}r.classList.remove(t),r.classList.remove(n),r.classList.add(n)}),p.addEventListener("click",function(i){r.value="",r.classList.remove(t),r.classList.remove(n)});const o=document.getElementById("recordArtifact"),w=document.getElementById("recordArtifactBtn"),k=document.getElementById("recordArtifactReset");o.addEventListener("change",function(i){o.value!=""&&o.classList.remove(t)}),w.addEventListener("click",function(i){if(o.value==""){o.classList.add(t),o.classList.remove(n);return}o.classList.remove(t),o.classList.remove(n),window.prompt("Replace "+o.value+`?
Type "yes" to confirm.`).toLowerCase()=="yes"&&o.classList.add(n)}),k.addEventListener("click",function(i){o.value="",o.classList.remove(t),o.classList.remove(n)});const g=document.getElementById("recordOnline"),h=document.getElementById("recordOnlineLabel");g.checked!=!0&&h.classList.add(m),g.addEventListener("change",function(i){g.checked==!0?h.classList.remove(m):h.classList.add(m)})})();
